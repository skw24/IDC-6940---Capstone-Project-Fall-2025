<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Renan Monteiro Barbosa">
<meta name="description" content="Trying to replicate the Stroke_results_1019_2025_latest">

<title>Reproducing Steve’s Code - Stroke_results_1019_2025_latest – IDC-6940 - Capstone Project Fall-2025</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark-2fef5ea3f8957b3e4ecc936fc74692ca.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-1773efb2f7ab98e3656670b7729847ad.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark-cef3429e03e90a75e86301dc8df8cee2.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="../../site_libs/bootstrap/bootstrap-1773efb2f7ab98e3656670b7729847ad.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">IDC-6940 - Capstone Project Fall-2025</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../report.html"> 
<span class="menu-text">Report</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../blog.html"> 
<span class="menu-text">Literature Review</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../people/index.html"> 
<span class="menu-text">About Us</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
    <a href="https://github.com/renanmb/IDC-6940---Capstone-Project-Fall-2025" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#setup-and-data-loading" id="toc-setup-and-data-loading" class="nav-link active" data-scroll-target="#setup-and-data-loading">1. Setup and Data Loading</a>
  <ul class="collapse">
  <li><a href="#load-libraries" id="toc-load-libraries" class="nav-link" data-scroll-target="#load-libraries">1.1 Load Libraries</a></li>
  <li><a href="#load-data" id="toc-load-data" class="nav-link" data-scroll-target="#load-data">1.2 Load Data</a></li>
  <li><a href="#prepare-dataset" id="toc-prepare-dataset" class="nav-link" data-scroll-target="#prepare-dataset">1.3 Prepare Dataset</a></li>
  </ul></li>
  <li><a href="#apply-logistic-regression" id="toc-apply-logistic-regression" class="nav-link" data-scroll-target="#apply-logistic-regression">2. Apply Logistic Regression</a></li>
  <li><a href="#testing-logistic-regression-model-assumptions" id="toc-testing-logistic-regression-model-assumptions" class="nav-link" data-scroll-target="#testing-logistic-regression-model-assumptions">3. Testing logistic Regression Model Assumptions</a>
  <ul class="collapse">
  <li><a href="#testing-assumption-1" id="toc-testing-assumption-1" class="nav-link" data-scroll-target="#testing-assumption-1">3.1 Testing Assumption 1</a></li>
  <li><a href="#testing-assumption-2" id="toc-testing-assumption-2" class="nav-link" data-scroll-target="#testing-assumption-2">3.2 Testing Assumption 2</a></li>
  <li><a href="#testing-assumption-3" id="toc-testing-assumption-3" class="nav-link" data-scroll-target="#testing-assumption-3">3.3 Testing Assumption 3</a></li>
  <li><a href="#testing-assumption-4" id="toc-testing-assumption-4" class="nav-link" data-scroll-target="#testing-assumption-4">3.4 Testing Assumption 4</a></li>
  </ul></li>
  <li><a href="#analysis-of-the-model" id="toc-analysis-of-the-model" class="nav-link" data-scroll-target="#analysis-of-the-model">4 Analysis of the Model</a>
  <ul class="collapse">
  <li><a href="#use-hosmer-lemesho-and-naglekerke-r" id="toc-use-hosmer-lemesho-and-naglekerke-r" class="nav-link" data-scroll-target="#use-hosmer-lemesho-and-naglekerke-r">4.1 Use Hosmer-lemesho and Naglekerke R</a></li>
  <li><a href="#predictive-capability" id="toc-predictive-capability" class="nav-link" data-scroll-target="#predictive-capability">4.2 Predictive Capability</a></li>
  </ul></li>
  <li><a href="#original-code" id="toc-original-code" class="nav-link" data-scroll-target="#original-code">Original Code</a>
  <ul class="collapse">
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Reproducing Steve’s Code - Stroke_results_1019_2025_latest</h1>
  <div class="quarto-categories">
    <div class="quarto-category">coding</div>
    <div class="quarto-category">week 8</div>
    <div class="quarto-category">renan</div>
  </div>
  </div>

<div>
  <div class="description">
    Trying to replicate the Stroke_results_1019_2025_latest
  </div>
</div>

<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author"><a href="https://github.com/renanmb">Renan Monteiro Barbosa</a> </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Master of Data Science Program @ The University of West Florida (UWF)
          </p>
      </div>
  </div>

<div class="quarto-title-meta">

      
  
    
  </div>
  


</header>


<p>On this document I try to replicate Steve code: <strong>Stroke_Results_1019_2025_latest_440PM_SW_For_Group.R</strong></p>
<section id="setup-and-data-loading" class="level2">
<h2 class="anchored" data-anchor-id="setup-and-data-loading">1. Setup and Data Loading</h2>
<p>First we need to install all packages, system dependencies and solve conflicts to produce a new renv.lock file.</p>
<section id="load-libraries" class="level3">
<h3 class="anchored" data-anchor-id="load-libraries">1.1 Load Libraries</h3>
<p>Install packages if necessary:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run this once to install all the necessary packages</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("dplyr")</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("car")</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("ResourceSelection")</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("caret")</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("rcompanion")</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("pROC")</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("cvAUC")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Load Libraries:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For data manipulation and visualization</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co"># For data preprocessing and modeling</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mice)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ROSE) <span class="co"># For SMOTE</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ranger) <span class="co"># A fast implementation of random forests</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co"># For stacking/ensemble models</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stacks)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidymodels)</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(themis)</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gghighlight)</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pscl)</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ResourceSelection)</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rcompanion)</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Hmisc)</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pROC)</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cvAUC)</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Set seed for reproducibility</span></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="possible-issues-and-conflicts-to-resolve" class="level4">
<h4 class="anchored" data-anchor-id="possible-issues-and-conflicts-to-resolve">1.1.1 Possible Issues and conflicts to resolve</h4>
<div class="sourceCode" id="cb3"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{bash}</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> <span class="co"># For data manipulation and visualization</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> library<span class="kw">(</span><span class="ex">tidyverse</span><span class="kw">)</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="ex">library</span><span class="er">(</span><span class="ex">ggplot2</span><span class="kw">)</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="ex">library</span><span class="er">(</span><span class="ex">corrplot</span><span class="kw">)</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="ex">library</span><span class="er">(</span><span class="ex">knitr</span><span class="kw">)</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="ex">library</span><span class="er">(</span><span class="ex">ggpubr</span><span class="kw">)</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co"># For data preprocessing and modeling</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="ex">library</span><span class="er">(</span><span class="ex">mice</span><span class="kw">)</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="ex">library</span><span class="er">(</span><span class="ex">ROSE</span><span class="kw">)</span> <span class="co"># For SMOTE</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="ex">library</span><span class="er">(</span><span class="ex">ranger</span><span class="kw">)</span> <span class="co"># A fast implementation of random forests</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="co"># For stacking/ensemble models</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="ex">library</span><span class="er">(</span><span class="ex">stacks</span><span class="kw">)</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="ex">library</span><span class="er">(</span><span class="ex">tidymodels</span><span class="kw">)</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="ex">library</span><span class="er">(</span><span class="ex">themis</span><span class="kw">)</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="ex">library</span><span class="er">(</span><span class="ex">gghighlight</span><span class="kw">)</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="ex">library</span><span class="er">(</span><span class="ex">pscl</span><span class="kw">)</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="ex">library</span><span class="er">(</span><span class="ex">dplyr</span><span class="kw">)</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a><span class="ex">library</span><span class="er">(</span><span class="ex">car</span><span class="kw">)</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a><span class="ex">library</span><span class="er">(</span><span class="ex">ResourceSelection</span><span class="kw">)</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a><span class="ex">library</span><span class="er">(</span><span class="ex">caret</span><span class="kw">)</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a><span class="ex">library</span><span class="er">(</span><span class="ex">rcompanion</span><span class="kw">)</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a><span class="ex">library</span><span class="er">(</span><span class="ex">Hmisc</span><span class="kw">)</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a><span class="ex">library</span><span class="er">(</span><span class="ex">pROC</span><span class="kw">)</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a><span class="ex">library</span><span class="er">(</span><span class="ex">cvAUC</span><span class="kw">)</span></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Set seed for reproducibility</span></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a><span class="ex">set.seed</span><span class="er">(</span><span class="ex">123</span><span class="kw">)</span></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a><span class="ex">──</span> Attaching core tidyverse packages ────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── tidyverse 2.0.0 ──</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a><span class="ex">✔</span> dplyr     1.1.4     ✔ readr     2.1.5</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a><span class="ex">✔</span> forcats   1.0.0     ✔ stringr   1.5.1</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a><span class="ex">✔</span> ggplot2   3.5.2     ✔ tibble    3.3.0</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a><span class="ex">✔</span> lubridate 1.9.4     ✔ tidyr     1.3.1</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a><span class="ex">✔</span> purrr     1.1.0     </span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a><span class="ex">──</span> Conflicts ──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── tidyverse_conflicts<span class="er">(</span><span class="kw">)</span> <span class="ex">──</span></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a><span class="ex">✖</span> dplyr::filter<span class="er">(</span><span class="kw">)</span> <span class="ex">masks</span> stats::filter<span class="er">(</span><span class="kw">)</span></span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a><span class="ex">✖</span> dplyr::lag<span class="er">(</span><span class="kw">)</span>    <span class="ex">masks</span> stats::lag<span class="er">(</span><span class="kw">)</span></span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a><span class="ex">ℹ</span> Use the conflicted package <span class="er">(</span><span class="op">&lt;</span>http://conflicted.r-lib.org/<span class="op">&gt;</span><span class="kw">)</span> <span class="ex">to</span> force all conflicts to become errors</span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> library<span class="kw">(</span><span class="ex">ggplot2</span><span class="kw">)</span></span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> library<span class="kw">(</span><span class="ex">corrplot</span><span class="kw">)</span></span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a><span class="ex">corrplot</span> 0.95 loaded</span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> library<span class="kw">(</span><span class="ex">knitr</span><span class="kw">)</span></span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> library<span class="kw">(</span><span class="ex">ggpubr</span><span class="kw">)</span></span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> </span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> <span class="co"># For data preprocessing and modeling</span></span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> library<span class="kw">(</span><span class="ex">mice</span><span class="kw">)</span></span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a><span class="ex">Attaching</span> package: ‘mice’</span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a><span class="ex">The</span> following object is masked from ‘package:stats’:</span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>    <span class="ex">filter</span></span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a><span class="ex">The</span> following objects are masked from ‘package:base’:</span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a>    <span class="ex">cbind,</span> rbind</span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> library<span class="kw">(</span><span class="ex">ROSE</span><span class="kw">)</span> <span class="co"># For SMOTE</span></span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a><span class="ex">Loaded</span> ROSE 0.0-4</span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> library<span class="kw">(</span><span class="ex">ranger</span><span class="kw">)</span> <span class="co"># A fast implementation of random forests</span></span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a><span class="ex">ranger</span> 0.17.0 using 2 threads <span class="er">(</span><span class="ex">default</span><span class="kw">)</span><span class="bu">.</span> Change with num.threads in ranger<span class="er">(</span><span class="kw">)</span> <span class="ex">and</span> predict<span class="er">(</span><span class="kw">)</span><span class="ex">,</span> options<span class="er">(</span><span class="ex">Ncpus</span> = N<span class="kw">)</span><span class="ex">,</span> options<span class="er">(</span><span class="ex">ranger.num.threads</span> = N<span class="kw">)</span> <span class="ex">or</span> environment variable R_RANGER_NUM_THREADS.</span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> </span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> <span class="co"># For stacking/ensemble models</span></span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> library<span class="kw">(</span><span class="ex">stacks</span><span class="kw">)</span></span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a><span class="ex">Registered</span> S3 method overwritten by <span class="st">'butcher'</span>:</span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a>  <span class="ex">method</span>                 from    </span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true" tabindex="-1"></a>  <span class="ex">as.character.dev_topic</span> generics</span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> library<span class="kw">(</span><span class="ex">tidymodels</span><span class="kw">)</span></span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true" tabindex="-1"></a><span class="ex">──</span> Attaching packages ──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── tidymodels 1.4.1 ──</span>
<span id="cb3-76"><a href="#cb3-76" aria-hidden="true" tabindex="-1"></a><span class="ex">✔</span> broom        1.0.9     ✔ rsample      1.3.1</span>
<span id="cb3-77"><a href="#cb3-77" aria-hidden="true" tabindex="-1"></a><span class="ex">✔</span> dials        1.4.2     ✔ tailor       0.1.0</span>
<span id="cb3-78"><a href="#cb3-78" aria-hidden="true" tabindex="-1"></a><span class="ex">✔</span> infer        1.0.9     ✔ tune         2.0.0</span>
<span id="cb3-79"><a href="#cb3-79" aria-hidden="true" tabindex="-1"></a><span class="ex">✔</span> modeldata    1.5.1     ✔ workflows    1.3.0</span>
<span id="cb3-80"><a href="#cb3-80" aria-hidden="true" tabindex="-1"></a><span class="ex">✔</span> parsnip      1.3.3     ✔ workflowsets 1.1.1</span>
<span id="cb3-81"><a href="#cb3-81" aria-hidden="true" tabindex="-1"></a><span class="ex">✔</span> recipes      1.3.1     ✔ yardstick    1.3.2</span>
<span id="cb3-82"><a href="#cb3-82" aria-hidden="true" tabindex="-1"></a><span class="ex">──</span> Conflicts ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── tidymodels_conflicts<span class="er">(</span><span class="kw">)</span> <span class="ex">──</span></span>
<span id="cb3-83"><a href="#cb3-83" aria-hidden="true" tabindex="-1"></a><span class="ex">✖</span> scales::discard<span class="er">(</span><span class="kw">)</span> <span class="ex">masks</span> purrr::discard<span class="er">(</span><span class="kw">)</span></span>
<span id="cb3-84"><a href="#cb3-84" aria-hidden="true" tabindex="-1"></a><span class="ex">✖</span> mice::filter<span class="er">(</span><span class="kw">)</span>    <span class="ex">masks</span> dplyr::filter<span class="er">(</span><span class="kw">)</span><span class="ex">,</span> stats::filter<span class="er">(</span><span class="kw">)</span></span>
<span id="cb3-85"><a href="#cb3-85" aria-hidden="true" tabindex="-1"></a><span class="ex">✖</span> recipes::fixed<span class="er">(</span><span class="kw">)</span>  <span class="ex">masks</span> stringr::fixed<span class="er">(</span><span class="kw">)</span></span>
<span id="cb3-86"><a href="#cb3-86" aria-hidden="true" tabindex="-1"></a><span class="ex">✖</span> dplyr::lag<span class="er">(</span><span class="kw">)</span>      <span class="ex">masks</span> stats::lag<span class="er">(</span><span class="kw">)</span></span>
<span id="cb3-87"><a href="#cb3-87" aria-hidden="true" tabindex="-1"></a><span class="ex">✖</span> yardstick::spec<span class="er">(</span><span class="kw">)</span> <span class="ex">masks</span> readr::spec<span class="er">(</span><span class="kw">)</span></span>
<span id="cb3-88"><a href="#cb3-88" aria-hidden="true" tabindex="-1"></a><span class="ex">✖</span> recipes::step<span class="er">(</span><span class="kw">)</span>   <span class="ex">masks</span> stats::step<span class="er">(</span><span class="kw">)</span></span>
<span id="cb3-89"><a href="#cb3-89" aria-hidden="true" tabindex="-1"></a><span class="ex">•</span> Use tidymodels_prefer<span class="er">(</span><span class="kw">)</span> <span class="ex">to</span> resolve common conflicts.</span>
<span id="cb3-90"><a href="#cb3-90" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> </span>
<span id="cb3-91"><a href="#cb3-91" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> library<span class="kw">(</span><span class="ex">themis</span><span class="kw">)</span></span>
<span id="cb3-92"><a href="#cb3-92" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> library<span class="kw">(</span><span class="ex">gghighlight</span><span class="kw">)</span></span>
<span id="cb3-93"><a href="#cb3-93" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> </span>
<span id="cb3-94"><a href="#cb3-94" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> library<span class="kw">(</span><span class="ex">pscl</span><span class="kw">)</span></span>
<span id="cb3-95"><a href="#cb3-95" aria-hidden="true" tabindex="-1"></a><span class="ex">Classes</span> and Methods for R originally developed in the</span>
<span id="cb3-96"><a href="#cb3-96" aria-hidden="true" tabindex="-1"></a><span class="ex">Political</span> Science Computational Laboratory</span>
<span id="cb3-97"><a href="#cb3-97" aria-hidden="true" tabindex="-1"></a><span class="ex">Department</span> of Political Science</span>
<span id="cb3-98"><a href="#cb3-98" aria-hidden="true" tabindex="-1"></a><span class="ex">Stanford</span> University <span class="er">(</span><span class="ex">2002-2015</span><span class="kw">)</span><span class="ex">,</span></span>
<span id="cb3-99"><a href="#cb3-99" aria-hidden="true" tabindex="-1"></a><span class="ex">by</span> and under the direction of Simon Jackman.</span>
<span id="cb3-100"><a href="#cb3-100" aria-hidden="true" tabindex="-1"></a><span class="ex">hurdle</span> and zeroinfl functions by Achim Zeileis.</span>
<span id="cb3-101"><a href="#cb3-101" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> library<span class="kw">(</span><span class="ex">dplyr</span><span class="kw">)</span></span>
<span id="cb3-102"><a href="#cb3-102" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> library<span class="kw">(</span><span class="ex">car</span><span class="kw">)</span></span>
<span id="cb3-103"><a href="#cb3-103" aria-hidden="true" tabindex="-1"></a><span class="ex">Loading</span> required package: carData</span>
<span id="cb3-104"><a href="#cb3-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-105"><a href="#cb3-105" aria-hidden="true" tabindex="-1"></a><span class="ex">Attaching</span> package: ‘car’</span>
<span id="cb3-106"><a href="#cb3-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-107"><a href="#cb3-107" aria-hidden="true" tabindex="-1"></a><span class="ex">The</span> following object is masked from ‘package:dplyr’:</span>
<span id="cb3-108"><a href="#cb3-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-109"><a href="#cb3-109" aria-hidden="true" tabindex="-1"></a>    <span class="ex">recode</span></span>
<span id="cb3-110"><a href="#cb3-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-111"><a href="#cb3-111" aria-hidden="true" tabindex="-1"></a><span class="ex">The</span> following object is masked from ‘package:purrr’:</span>
<span id="cb3-112"><a href="#cb3-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-113"><a href="#cb3-113" aria-hidden="true" tabindex="-1"></a>    <span class="ex">some</span></span>
<span id="cb3-114"><a href="#cb3-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-115"><a href="#cb3-115" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> library<span class="kw">(</span><span class="ex">ResourceSelection</span><span class="kw">)</span></span>
<span id="cb3-116"><a href="#cb3-116" aria-hidden="true" tabindex="-1"></a><span class="ex">ResourceSelection</span> 0.3-6          2023-06-27</span>
<span id="cb3-117"><a href="#cb3-117" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> library<span class="kw">(</span><span class="ex">caret</span><span class="kw">)</span></span>
<span id="cb3-118"><a href="#cb3-118" aria-hidden="true" tabindex="-1"></a><span class="ex">Loading</span> required package: lattice</span>
<span id="cb3-119"><a href="#cb3-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-120"><a href="#cb3-120" aria-hidden="true" tabindex="-1"></a><span class="ex">Attaching</span> package: ‘caret’</span>
<span id="cb3-121"><a href="#cb3-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-122"><a href="#cb3-122" aria-hidden="true" tabindex="-1"></a><span class="ex">The</span> following objects are masked from ‘package:yardstick’:</span>
<span id="cb3-123"><a href="#cb3-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-124"><a href="#cb3-124" aria-hidden="true" tabindex="-1"></a>    <span class="ex">precision,</span> recall, sensitivity, specificity</span>
<span id="cb3-125"><a href="#cb3-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-126"><a href="#cb3-126" aria-hidden="true" tabindex="-1"></a><span class="ex">The</span> following object is masked from ‘package:rsample’:</span>
<span id="cb3-127"><a href="#cb3-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-128"><a href="#cb3-128" aria-hidden="true" tabindex="-1"></a>    <span class="ex">calibration</span></span>
<span id="cb3-129"><a href="#cb3-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-130"><a href="#cb3-130" aria-hidden="true" tabindex="-1"></a><span class="ex">The</span> following object is masked from ‘package:purrr’:</span>
<span id="cb3-131"><a href="#cb3-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-132"><a href="#cb3-132" aria-hidden="true" tabindex="-1"></a>    <span class="ex">lift</span></span>
<span id="cb3-133"><a href="#cb3-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-134"><a href="#cb3-134" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> library<span class="kw">(</span><span class="ex">rcompanion</span><span class="kw">)</span></span>
<span id="cb3-135"><a href="#cb3-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-136"><a href="#cb3-136" aria-hidden="true" tabindex="-1"></a><span class="ex">Attaching</span> package: ‘rcompanion’</span>
<span id="cb3-137"><a href="#cb3-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-138"><a href="#cb3-138" aria-hidden="true" tabindex="-1"></a><span class="ex">The</span> following object is masked from ‘package:yardstick’:</span>
<span id="cb3-139"><a href="#cb3-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-140"><a href="#cb3-140" aria-hidden="true" tabindex="-1"></a>    <span class="ex">accuracy</span></span>
<span id="cb3-141"><a href="#cb3-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-142"><a href="#cb3-142" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> library<span class="kw">(</span><span class="ex">Hmisc</span><span class="kw">)</span></span>
<span id="cb3-143"><a href="#cb3-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-144"><a href="#cb3-144" aria-hidden="true" tabindex="-1"></a><span class="ex">Attaching</span> package: ‘Hmisc’</span>
<span id="cb3-145"><a href="#cb3-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-146"><a href="#cb3-146" aria-hidden="true" tabindex="-1"></a><span class="ex">The</span> following object is masked from ‘package:parsnip’:</span>
<span id="cb3-147"><a href="#cb3-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-148"><a href="#cb3-148" aria-hidden="true" tabindex="-1"></a>    <span class="ex">translate</span></span>
<span id="cb3-149"><a href="#cb3-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-150"><a href="#cb3-150" aria-hidden="true" tabindex="-1"></a><span class="ex">The</span> following objects are masked from ‘package:dplyr’:</span>
<span id="cb3-151"><a href="#cb3-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-152"><a href="#cb3-152" aria-hidden="true" tabindex="-1"></a>    <span class="ex">src,</span> summarize</span>
<span id="cb3-153"><a href="#cb3-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-154"><a href="#cb3-154" aria-hidden="true" tabindex="-1"></a><span class="ex">The</span> following objects are masked from ‘package:base’:</span>
<span id="cb3-155"><a href="#cb3-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-156"><a href="#cb3-156" aria-hidden="true" tabindex="-1"></a>    <span class="ex">format.pval,</span> units</span>
<span id="cb3-157"><a href="#cb3-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-158"><a href="#cb3-158" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> library<span class="kw">(</span><span class="ex">pROC</span><span class="kw">)</span></span>
<span id="cb3-159"><a href="#cb3-159" aria-hidden="true" tabindex="-1"></a><span class="ex">Type</span> <span class="st">'citation("pROC")'</span> for a citation.</span>
<span id="cb3-160"><a href="#cb3-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-161"><a href="#cb3-161" aria-hidden="true" tabindex="-1"></a><span class="ex">Attaching</span> package: ‘pROC’</span>
<span id="cb3-162"><a href="#cb3-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-163"><a href="#cb3-163" aria-hidden="true" tabindex="-1"></a><span class="ex">The</span> following objects are masked from ‘package:stats’:</span>
<span id="cb3-164"><a href="#cb3-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-165"><a href="#cb3-165" aria-hidden="true" tabindex="-1"></a>    <span class="ex">cov,</span> smooth, var</span>
<span id="cb3-166"><a href="#cb3-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-167"><a href="#cb3-167" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> library<span class="kw">(</span><span class="ex">cvAUC</span><span class="kw">)</span></span>
<span id="cb3-168"><a href="#cb3-168" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> </span>
<span id="cb3-169"><a href="#cb3-169" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> <span class="co"># Set seed for reproducibility</span></span>
<span id="cb3-170"><a href="#cb3-170" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> set.seed<span class="kw">(</span><span class="ex">123</span><span class="kw">)</span></span>
<span id="cb3-171"><a href="#cb3-171" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="load-data" class="level3">
<h3 class="anchored" data-anchor-id="load-data">1.2 Load Data</h3>
<p>Will be using my original Dataset as well Steve’s Dataset and compare for differences.</p>
<ul>
<li><strong>Renan</strong>: kaggle_data1</li>
<li><strong>Steve</strong>: stroke1</li>
</ul>
<section id="renan-dataset" class="level4">
<h4 class="anchored" data-anchor-id="renan-dataset">1.2.1 Renan Dataset</h4>
<p>Below will be loading the healthcare-dataset-stroke-data.csv and performing necessary changes to the dataset and loading into the DataFrame: kaggle_data1</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>find_git_root <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">start =</span> <span class="fu">getwd</span>()) {</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  path <span class="ot">&lt;-</span> <span class="fu">normalizePath</span>(start, <span class="at">winslash =</span> <span class="st">"/"</span>, <span class="at">mustWork =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (path <span class="sc">!=</span> <span class="fu">dirname</span>(path)) {</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">dir.exists</span>(<span class="fu">file.path</span>(path, <span class="st">".git"</span>))) <span class="fu">return</span>(path)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    path <span class="ot">&lt;-</span> <span class="fu">dirname</span>(path)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stop</span>(<span class="st">"No .git directory found — are you inside a Git repository?"</span>)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>repo_root <span class="ot">&lt;-</span> <span class="fu">find_git_root</span>()</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>datasets_path <span class="ot">&lt;-</span> <span class="fu">file.path</span>(repo_root, <span class="st">"datasets"</span>)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>kaggle_dataset_path <span class="ot">&lt;-</span> <span class="fu">file.path</span>(datasets_path, <span class="st">"kaggle-healthcare-dataset-stroke-data/healthcare-dataset-stroke-data.csv"</span>)</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>kaggle_data1 <span class="ot">=</span> <span class="fu">read_csv</span>(kaggle_dataset_path, <span class="at">show_col_types =</span> <span class="cn">FALSE</span>)</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="co"># unique(kaggle_data1$bmi)</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>kaggle_data1 <span class="ot">&lt;-</span> kaggle_data1 <span class="sc">%&gt;%</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">bmi =</span> <span class="fu">na_if</span>(bmi, <span class="st">"N/A"</span>)) <span class="sc">%&gt;%</span>   <span class="co"># Convert "N/A" string to NA</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">bmi =</span> <span class="fu">as.numeric</span>(bmi))         <span class="co"># Convert from character to numeric</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove the 'Other' gender row and the 'id' column</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>kaggle_data1 <span class="ot">&lt;-</span> kaggle_data1 <span class="sc">%&gt;%</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(gender <span class="sc">!=</span> <span class="st">"Other"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>id) <span class="sc">%&gt;%</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character, as.factor) <span class="co"># Convert character columns to factors for easier modeling</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="steve-dataset" class="level4">
<h4 class="anchored" data-anchor-id="steve-dataset">1.2.1 Steve Dataset</h4>
<p>Below will be loading the stroke.csv and performing necessary changes to the dataset and loading into the DataFrame: stroke1</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reading the datafile in (the same one you got for us Renan)#</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>steve_dataset_path <span class="ot">&lt;-</span> <span class="fu">file.path</span>(datasets_path, <span class="st">"steve/stroke.csv"</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>stroke1 <span class="ot">=</span> <span class="fu">read_csv</span>(steve_dataset_path, <span class="at">show_col_types =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="prepare-dataset" class="level3">
<h3 class="anchored" data-anchor-id="prepare-dataset">1.3 Prepare Dataset</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(stroke1)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(stroke1)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(stroke1)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>count_tables <span class="ot">&lt;-</span> <span class="fu">lapply</span>(stroke1, table)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>count_tables</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Part 1: preparing the data</p>
<ul>
<li><strong>Smoking Status</strong> - remove unknown</li>
<li><strong>bmi</strong> - remove N/A</li>
<li><strong>Work type</strong> - remove children</li>
<li><strong>age</strong> - create numerical variable with 2 places after the decimal</li>
<li><strong>gender</strong> - remove other</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>stroke1[stroke1 <span class="sc">==</span> <span class="st">"N/A"</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>stroke1[stroke1 <span class="sc">==</span> <span class="st">"Unknown"</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>stroke1[stroke1 <span class="sc">==</span> <span class="st">"children"</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>stroke1[stroke1 <span class="sc">==</span> <span class="st">"other"</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>stroke1<span class="sc">$</span>bmi <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(stroke1<span class="sc">$</span>bmi), <span class="dv">2</span>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>stroke1<span class="sc">$</span>gender[stroke1<span class="sc">$</span>gender <span class="sc">==</span> <span class="st">"Male"</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>stroke1<span class="sc">$</span>gender[stroke1<span class="sc">$</span>gender <span class="sc">==</span> <span class="st">"Female"</span>] <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>stroke1<span class="sc">$</span>gender <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(stroke1<span class="sc">$</span>gender)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: NAs introduced by coercion</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>stroke1<span class="sc">$</span>ever_married[stroke1<span class="sc">$</span>ever_married <span class="sc">==</span> <span class="st">"Yes"</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>stroke1<span class="sc">$</span>ever_married[stroke1<span class="sc">$</span>ever_married <span class="sc">==</span> <span class="st">"No"</span>] <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>stroke1<span class="sc">$</span>ever_married <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(stroke1<span class="sc">$</span>ever_married)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>stroke1<span class="sc">$</span>work_type[stroke1<span class="sc">$</span>work_type <span class="sc">==</span> <span class="st">"Govt_job"</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>stroke1<span class="sc">$</span>work_type[stroke1<span class="sc">$</span>work_type <span class="sc">==</span> <span class="st">"Private"</span>] <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>stroke1<span class="sc">$</span>work_type[stroke1<span class="sc">$</span>work_type <span class="sc">==</span> <span class="st">"Self-employed"</span>] <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>stroke1<span class="sc">$</span>work_type[stroke1<span class="sc">$</span>work_type <span class="sc">==</span> <span class="st">"Never_worked"</span>] <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>stroke1<span class="sc">$</span>work_type <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(stroke1<span class="sc">$</span>work_type)</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>stroke1<span class="sc">$</span>Residence_type[stroke1<span class="sc">$</span>Residence_type <span class="sc">==</span> <span class="st">"Urban"</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>stroke1<span class="sc">$</span>Residence_type[stroke1<span class="sc">$</span>Residence_type <span class="sc">==</span> <span class="st">"Rural"</span>] <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>stroke1<span class="sc">$</span>Residence_type <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(stroke1<span class="sc">$</span>Residence_type)</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>stroke1<span class="sc">$</span>avg_glucose_level <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(stroke1<span class="sc">$</span>avg_glucose_level)</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>stroke1<span class="sc">$</span>heart_disease <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(stroke1<span class="sc">$</span>heart_disease)</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>stroke1<span class="sc">$</span>hypertension <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(stroke1<span class="sc">$</span>hypertension)</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>stroke1<span class="sc">$</span>age <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(stroke1<span class="sc">$</span>age), <span class="dv">2</span>)</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>stroke1<span class="sc">$</span>stroke <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(stroke1<span class="sc">$</span>stroke)</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>stroke1<span class="sc">$</span>smoking_status[stroke1<span class="sc">$</span>smoking_status <span class="sc">==</span> <span class="st">"never smoked"</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>stroke1<span class="sc">$</span>smoking_status[stroke1<span class="sc">$</span>smoking_status <span class="sc">==</span> <span class="st">"formerly smoked"</span>] <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>stroke1<span class="sc">$</span>smoking_status[stroke1<span class="sc">$</span>smoking_status <span class="sc">==</span> <span class="st">"smokes"</span>] <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>stroke1<span class="sc">$</span>smoking_status <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(stroke1<span class="sc">$</span>smoking_status)</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>stroke1 <span class="ot">&lt;-</span> stroke1[, <span class="sc">!</span>(<span class="fu">names</span>(stroke1) <span class="sc">%in%</span> <span class="st">"id"</span>)]</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>stroke1_clean <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(stroke1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>converted all columns to numeric and removed id</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># converted all columns to numeric and removed id</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(stroke1_clean)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(stroke1_clean)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>LR_stroke1 <span class="ot">&lt;-</span> stroke1_clean</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(LR_stroke1)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>count_tables <span class="ot">&lt;-</span> <span class="fu">lapply</span>(LR_stroke1, table)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>count_tables</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="apply-logistic-regression" class="level2">
<h2 class="anchored" data-anchor-id="apply-logistic-regression">2. Apply Logistic Regression</h2>
<p>Part 2:Create and Run the Logistic Regression model from the dataset</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Part 2:Create and Run the Logistic Regression model from the  dataset</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">glm</span>(stroke <span class="sc">~</span> gender <span class="sc">+</span> age <span class="sc">+</span> hypertension <span class="sc">+</span> heart_disease <span class="sc">+</span> ever_married <span class="sc">+</span> work_type <span class="sc">+</span> Residence_type <span class="sc">+</span> avg_glucose_level <span class="sc">+</span> bmi <span class="sc">+</span> smoking_status, <span class="at">data=</span>LR_stroke1, <span class="at">family =</span> binomial)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = stroke ~ gender + age + hypertension + heart_disease + 
    ever_married + work_type + Residence_type + avg_glucose_level + 
    bmi + smoking_status, family = binomial, data = LR_stroke1)

Coefficients:
                   Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)       -8.426854   0.873243  -9.650  &lt; 2e-16 ***
gender             0.080370   0.167274   0.480 0.630893    
age                0.070967   0.006845  10.368  &lt; 2e-16 ***
hypertension       0.570797   0.182580   3.126 0.001770 ** 
heart_disease      0.417884   0.220311   1.897 0.057856 .  
ever_married       0.174316   0.261832   0.666 0.505569    
work_type         -0.109615   0.126101  -0.869 0.384703    
Residence_type     0.005932   0.162188   0.037 0.970822    
avg_glucose_level  0.004658   0.001375   3.388 0.000704 ***
bmi                0.006275   0.012875   0.487 0.625954    
smoking_status     0.179921   0.106431   1.691 0.090932 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1403.5  on 3356  degrees of freedom
Residual deviance: 1145.4  on 3346  degrees of freedom
AIC: 1167.4

Number of Fisher Scoring iterations: 7</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Issue - Unbalanced Data set
</div>
</div>
<div class="callout-body-container callout-body">
<p>The dataset is oversampling stroke rate by 77%.</p>
</div>
</div>
<p>Issue - Unbalanced Data set</p>
<p>The <span class="math inline">\(stroke rate = 180/3357 = 054%\)</span> . But the stroke rate in the US is 3.1% by the CDC, AHA, and the NCHS.</p>
<p>The dataset is oversampling stroke rate by 77%. We can either SMOTE, under/over sample….but too much time</p>
<p>Best way is to recalibrate the intercept for this model (Ie change it here) so it can be used from now on</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Issue _ Unbalanced Data set #</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co"># The stroke rate = 180/3357 = 054%. But the stroke rate in the US is 3.1% by the CDC, AHA, and the NCHS. #</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co"># The dataset is oversampling stroke rate by 77%. We can either SMOTE, under/over sample....but too much time #</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Best way is to recalibrate the intercept for this model (Ie change it here) so it can be used from now on #</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>ds_prev <span class="ot">&lt;-</span> .<span class="dv">054</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>pop_prev <span class="ot">&lt;-</span> .<span class="dv">031</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>log_odds_ds <span class="ot">&lt;-</span> <span class="fu">qlogis</span>(ds_prev)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>log_odds_pop <span class="ot">&lt;-</span> <span class="fu">qlogis</span>(pop_prev)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>offset <span class="ot">&lt;-</span> log_odds_pop <span class="sc">-</span> log_odds_ds</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>coefs <span class="ot">&lt;-</span> <span class="fu">coef</span>(model)</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>coefs[<span class="dv">1</span>] <span class="ot">&lt;-</span> coefs[<span class="dv">1</span>] <span class="sc">+</span> offset</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(coefs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      (Intercept)            gender               age      hypertension 
     -9.005873116       0.080369937       0.070967479       0.570796782 
    heart_disease      ever_married         work_type    Residence_type 
      0.417883562       0.174315603      -0.109615162       0.005932360 
avg_glucose_level               bmi    smoking_status 
      0.004657820       0.006275415       0.179921439 </code></pre>
</div>
</div>
<p>Original Intercept Coeff = -8.426854231</p>
<p>Changed intercept Coefficent to take into account current stroke rate or 3.1% = -9.005873116</p>
<p>all the other intercepts remain the same</p>
</section>
<section id="testing-logistic-regression-model-assumptions" class="level2">
<h2 class="anchored" data-anchor-id="testing-logistic-regression-model-assumptions">3. Testing logistic Regression Model Assumptions</h2>
<p>Part 3: Testing logistic Regression Model Assumptions</p>
<p>There are several assumptions for Logistic Regression. They are:</p>
<ol type="1">
<li>The Dependent Variable is binary (i.e, 0 or 1)</li>
<li>There is a linear relationship between th logit of the outcome and each predictor</li>
<li>There are NO high leverage outliers in the predictors</li>
<li>There is No high multicollinearity (ie strong correlations) between predictors</li>
</ol>
<p>Now to test each assumption</p>
<section id="testing-assumption-1" class="level3">
<h3 class="anchored" data-anchor-id="testing-assumption-1">3.1 Testing Assumption 1</h3>
<p>Testing Assumption 1: The Dependent Variable is binary (0 or 1)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(LR_stroke1<span class="sc">$</span>stroke)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 0</code></pre>
</div>
</div>
</section>
<section id="testing-assumption-2" class="level3">
<h3 class="anchored" data-anchor-id="testing-assumption-2">3.2 Testing Assumption 2</h3>
<p>Testing Assumption 2: There is a linear relationship between the outcome variable and each predictor</p>
<p>first, adjust all predictors so all values are positive</p>
<p>Conclusion: For all continuous variables , ageadj, avg_glucose_leveladj, and bniadj, the residual plots show linearity</p>
<p>Conclusion: all the other predictors are categorical, with the magenta line flat, and the values clustering around certain values, they are also appropriate for logistic regression</p>
<p>Conclusion for assumption 2 - Linearity is met</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>LR_stroke1<span class="sc">$</span>genderadj <span class="ot">&lt;-</span> LR_stroke1<span class="sc">$</span>gender <span class="sc">+</span> <span class="fu">abs</span>(<span class="fu">min</span>(LR_stroke1<span class="sc">$</span>gender)) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>LR_stroke1<span class="sc">$</span>ageadj <span class="ot">&lt;-</span> LR_stroke1<span class="sc">$</span>age <span class="sc">+</span> <span class="fu">abs</span>(<span class="fu">min</span>(LR_stroke1<span class="sc">$</span>age)) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>LR_stroke1<span class="sc">$</span>hypertensionadj <span class="ot">&lt;-</span> LR_stroke1<span class="sc">$</span>hypertension <span class="sc">+</span> <span class="fu">abs</span>(<span class="fu">min</span>(LR_stroke1<span class="sc">$</span>hypertension)) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>LR_stroke1<span class="sc">$</span>heart_diseaseadj <span class="ot">&lt;-</span> LR_stroke1<span class="sc">$</span>heart_disease <span class="sc">+</span> <span class="fu">abs</span>(<span class="fu">min</span>(LR_stroke1<span class="sc">$</span>hypertension)) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>LR_stroke1<span class="sc">$</span>ever_marriedadj <span class="ot">&lt;-</span> LR_stroke1<span class="sc">$</span>ever_married <span class="sc">+</span> <span class="fu">abs</span>(<span class="fu">min</span>(LR_stroke1<span class="sc">$</span>ever_married)) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>LR_stroke1<span class="sc">$</span>work_typeadj <span class="ot">&lt;-</span> LR_stroke1<span class="sc">$</span>work_type <span class="sc">+</span> <span class="fu">abs</span>(<span class="fu">min</span>(LR_stroke1<span class="sc">$</span>work_type)) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>LR_stroke1<span class="sc">$</span>Residence_typeadj <span class="ot">&lt;-</span> LR_stroke1<span class="sc">$</span>Residence_type <span class="sc">+</span> <span class="fu">abs</span>(<span class="fu">min</span>(LR_stroke1<span class="sc">$</span>Residence_type)) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>LR_stroke1<span class="sc">$</span>avg_glucose_leveladj <span class="ot">&lt;-</span> LR_stroke1<span class="sc">$</span>avg_glucose_level <span class="sc">+</span> <span class="fu">abs</span>(<span class="fu">min</span>(LR_stroke1<span class="sc">$</span>avg_glucose_level)) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>LR_stroke1<span class="sc">$</span>bmiadj <span class="ot">&lt;-</span> LR_stroke1<span class="sc">$</span>bmi <span class="sc">+</span> <span class="fu">abs</span>(<span class="fu">min</span>(LR_stroke1<span class="sc">$</span>bmi)) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>LR_stroke1<span class="sc">$</span>smoking_statusadj <span class="ot">&lt;-</span> LR_stroke1<span class="sc">$</span>smoking_status <span class="sc">+</span> <span class="fu">abs</span>(<span class="fu">min</span>(LR_stroke1<span class="sc">$</span>smoking_status)) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(LR_stroke1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [3,357 × 21] (S3: tbl_df/tbl/data.frame)
 $ gender              : num [1:3357] 1 1 2 2 1 1 2 2 2 2 ...
 $ age                 : num [1:3357] 67 80 49 79 81 74 69 81 61 54 ...
 $ hypertension        : num [1:3357] 0 0 0 1 0 1 0 1 0 0 ...
 $ heart_disease       : num [1:3357] 1 1 0 0 0 1 0 0 1 0 ...
 $ ever_married        : num [1:3357] 1 1 1 1 1 1 2 1 1 1 ...
 $ work_type           : num [1:3357] 2 2 2 3 2 2 2 2 1 2 ...
 $ Residence_type      : num [1:3357] 1 2 1 2 1 2 1 2 2 1 ...
 $ avg_glucose_level   : num [1:3357] 229 106 171 174 186 ...
 $ bmi                 : num [1:3357] 36.6 32.5 34.4 24 29 27.4 22.8 29.7 36.8 27.3 ...
 $ smoking_status      : num [1:3357] 2 1 3 1 2 1 1 1 3 3 ...
 $ stroke              : num [1:3357] 1 1 1 1 1 1 1 1 1 1 ...
 $ genderadj           : num [1:3357] 3 3 4 4 3 3 4 4 4 4 ...
 $ ageadj              : num [1:3357] 81 94 63 93 95 88 83 95 75 68 ...
 $ hypertensionadj     : num [1:3357] 1 1 1 2 1 2 1 2 1 1 ...
 $ heart_diseaseadj    : num [1:3357] 2 2 1 1 1 2 1 1 2 1 ...
 $ ever_marriedadj     : num [1:3357] 3 3 3 3 3 3 4 3 3 3 ...
 $ work_typeadj        : num [1:3357] 4 4 4 5 4 4 4 4 3 4 ...
 $ Residence_typeadj   : num [1:3357] 3 4 3 4 3 4 3 4 4 3 ...
 $ avg_glucose_leveladj: num [1:3357] 285 162 227 230 242 ...
 $ bmiadj              : num [1:3357] 49.1 45 46.9 36.5 41.5 39.9 35.3 42.2 49.3 39.8 ...
 $ smoking_statusadj   : num [1:3357] 4 3 5 3 4 3 3 3 5 5 ...
 - attr(*, "na.action")= 'omit' Named int [1:1753] 2 9 10 14 20 24 28 30 32 39 ...
  ..- attr(*, "names")= chr [1:1753] "2" "9" "10" "14" ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>StrokeAdj <span class="ot">&lt;-</span> LR_stroke1</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>StrokeAdj <span class="ot">&lt;-</span> StrokeAdj[ , <span class="sc">!</span>(<span class="fu">names</span>(StrokeAdj) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"gender"</span>, <span class="st">"age"</span>, <span class="st">"hypertension"</span>, <span class="st">"heart_disease"</span>, <span class="st">"ever_married"</span>, <span class="st">"work_type"</span>, <span class="st">"Residence_type"</span>, <span class="st">"avg_glucose_level"</span>, <span class="st">"bmi"</span>, <span class="st">"smoking_status"</span>)) ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Fit the model</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>mod<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">glm</span>(stroke <span class="sc">~</span> genderadj <span class="sc">+</span> ageadj <span class="sc">+</span> hypertensionadj <span class="sc">+</span> heart_diseaseadj <span class="sc">+</span> ever_marriedadj <span class="sc">+</span> work_typeadj <span class="sc">+</span> Residence_typeadj <span class="sc">+</span> avg_glucose_leveladj <span class="sc">+</span> bmiadj <span class="sc">+</span> smoking_statusadj, <span class="at">data=</span>StrokeAdj, <span class="at">family=</span>binomial)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot Residuals</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">residualPlots</span>(mod<span class="fl">.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Stroke_Results_1019_2025_latest_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Stroke_Results_1019_2025_latest_files/figure-html/unnamed-chunk-10-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                     Test stat Pr(&gt;|Test stat|)  
genderadj               0.0000          1.00000  
ageadj                  2.0626          0.15095  
hypertensionadj         0.0000          1.00000  
heart_diseaseadj        0.0000          1.00000  
ever_marriedadj         0.0000          1.00000  
work_typeadj            3.1406          0.07636 .
Residence_typeadj       0.0000          1.00000  
avg_glucose_leveladj    0.0103          0.91921  
bmiadj                  0.3947          0.52983  
smoking_statusadj       0.4775          0.48953  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="testing-assumption-3" class="level3">
<h3 class="anchored" data-anchor-id="testing-assumption-3">3.3 Testing Assumption 3</h3>
<p>Testing Assumption 3: assess influential outliers using car package and influencePlot</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">alias</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Model :
stroke ~ gender + age + hypertension + heart_disease + ever_married + 
    work_type + Residence_type + avg_glucose_level + bmi + smoking_status</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("Hmisc")</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="co"># library(Hmisc)</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rcorr</span>(<span class="fu">as.matrix</span>(LR_stroke1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                     gender   age hypertension heart_disease ever_married
gender                 1.00 -0.06        -0.04         -0.10         0.03
age                   -0.06  1.00         0.26          0.26        -0.49
hypertension          -0.04  0.26         1.00          0.11        -0.11
heart_disease         -0.10  0.26         0.11          1.00        -0.07
ever_married           0.03 -0.49        -0.11         -0.07         1.00
work_type              0.01  0.14         0.05          0.03        -0.02
Residence_type        -0.01 -0.02         0.00         -0.01         0.01
avg_glucose_level     -0.07  0.24         0.17          0.14        -0.12
bmi                   -0.02  0.04         0.13          0.00        -0.13
smoking_status        -0.08  0.03        -0.01          0.06        -0.06
stroke                -0.01  0.24         0.14          0.14        -0.07
genderadj              1.00 -0.06        -0.04         -0.10         0.03
ageadj                -0.06  1.00         0.26          0.26        -0.49
hypertensionadj       -0.04  0.26         1.00          0.11        -0.11
heart_diseaseadj      -0.10  0.26         0.11          1.00        -0.07
ever_marriedadj        0.03 -0.49        -0.11         -0.07         1.00
work_typeadj           0.01  0.14         0.05          0.03        -0.02
Residence_typeadj     -0.01 -0.02         0.00         -0.01         0.01
avg_glucose_leveladj  -0.07  0.24         0.17          0.14        -0.12
bmiadj                -0.02  0.04         0.13          0.00        -0.13
smoking_statusadj     -0.08  0.03        -0.01          0.06        -0.06
                     work_type Residence_type avg_glucose_level   bmi
gender                    0.01          -0.01             -0.07 -0.02
age                       0.14          -0.02              0.24  0.04
hypertension              0.05           0.00              0.17  0.13
heart_disease             0.03          -0.01              0.14  0.00
ever_married             -0.02           0.01             -0.12 -0.13
work_type                 1.00          -0.01              0.03 -0.02
Residence_type           -0.01           1.00              0.01  0.01
avg_glucose_level         0.03           0.01              1.00  0.16
bmi                      -0.02           0.01              0.16  1.00
smoking_status           -0.02          -0.04              0.01  0.03
stroke                    0.04          -0.01              0.14  0.01
genderadj                 0.01          -0.01             -0.07 -0.02
ageadj                    0.14          -0.02              0.24  0.04
hypertensionadj           0.05           0.00              0.17  0.13
heart_diseaseadj          0.03          -0.01              0.14  0.00
ever_marriedadj          -0.02           0.01             -0.12 -0.13
work_typeadj              1.00          -0.01              0.03 -0.02
Residence_typeadj        -0.01           1.00              0.01  0.01
avg_glucose_leveladj      0.03           0.01              1.00  0.16
bmiadj                   -0.02           0.01              0.16  1.00
smoking_statusadj        -0.02          -0.04              0.01  0.03
                     smoking_status stroke genderadj ageadj hypertensionadj
gender                        -0.08  -0.01      1.00  -0.06           -0.04
age                            0.03   0.24     -0.06   1.00            0.26
hypertension                  -0.01   0.14     -0.04   0.26            1.00
heart_disease                  0.06   0.14     -0.10   0.26            0.11
ever_married                  -0.06  -0.07      0.03  -0.49           -0.11
work_type                     -0.02   0.04      0.01   0.14            0.05
Residence_type                -0.04  -0.01     -0.01  -0.02            0.00
avg_glucose_level              0.01   0.14     -0.07   0.24            0.17
bmi                            0.03   0.01     -0.02   0.04            0.13
smoking_status                 1.00   0.02     -0.08   0.03           -0.01
stroke                         0.02   1.00     -0.01   0.24            0.14
genderadj                     -0.08  -0.01      1.00  -0.06           -0.04
ageadj                         0.03   0.24     -0.06   1.00            0.26
hypertensionadj               -0.01   0.14     -0.04   0.26            1.00
heart_diseaseadj               0.06   0.14     -0.10   0.26            0.11
ever_marriedadj               -0.06  -0.07      0.03  -0.49           -0.11
work_typeadj                  -0.02   0.04      0.01   0.14            0.05
Residence_typeadj             -0.04  -0.01     -0.01  -0.02            0.00
avg_glucose_leveladj           0.01   0.14     -0.07   0.24            0.17
bmiadj                         0.03   0.01     -0.02   0.04            0.13
smoking_statusadj              1.00   0.02     -0.08   0.03           -0.01
                     heart_diseaseadj ever_marriedadj work_typeadj
gender                          -0.10            0.03         0.01
age                              0.26           -0.49         0.14
hypertension                     0.11           -0.11         0.05
heart_disease                    1.00           -0.07         0.03
ever_married                    -0.07            1.00        -0.02
work_type                        0.03           -0.02         1.00
Residence_type                  -0.01            0.01        -0.01
avg_glucose_level                0.14           -0.12         0.03
bmi                              0.00           -0.13        -0.02
smoking_status                   0.06           -0.06        -0.02
stroke                           0.14           -0.07         0.04
genderadj                       -0.10            0.03         0.01
ageadj                           0.26           -0.49         0.14
hypertensionadj                  0.11           -0.11         0.05
heart_diseaseadj                 1.00           -0.07         0.03
ever_marriedadj                 -0.07            1.00        -0.02
work_typeadj                     0.03           -0.02         1.00
Residence_typeadj               -0.01            0.01        -0.01
avg_glucose_leveladj             0.14           -0.12         0.03
bmiadj                           0.00           -0.13        -0.02
smoking_statusadj                0.06           -0.06        -0.02
                     Residence_typeadj avg_glucose_leveladj bmiadj
gender                           -0.01                -0.07  -0.02
age                              -0.02                 0.24   0.04
hypertension                      0.00                 0.17   0.13
heart_disease                    -0.01                 0.14   0.00
ever_married                      0.01                -0.12  -0.13
work_type                        -0.01                 0.03  -0.02
Residence_type                    1.00                 0.01   0.01
avg_glucose_level                 0.01                 1.00   0.16
bmi                               0.01                 0.16   1.00
smoking_status                   -0.04                 0.01   0.03
stroke                           -0.01                 0.14   0.01
genderadj                        -0.01                -0.07  -0.02
ageadj                           -0.02                 0.24   0.04
hypertensionadj                   0.00                 0.17   0.13
heart_diseaseadj                 -0.01                 0.14   0.00
ever_marriedadj                   0.01                -0.12  -0.13
work_typeadj                     -0.01                 0.03  -0.02
Residence_typeadj                 1.00                 0.01   0.01
avg_glucose_leveladj              0.01                 1.00   0.16
bmiadj                            0.01                 0.16   1.00
smoking_statusadj                -0.04                 0.01   0.03
                     smoking_statusadj
gender                           -0.08
age                               0.03
hypertension                     -0.01
heart_disease                     0.06
ever_married                     -0.06
work_type                        -0.02
Residence_type                   -0.04
avg_glucose_level                 0.01
bmi                               0.03
smoking_status                    1.00
stroke                            0.02
genderadj                        -0.08
ageadj                            0.03
hypertensionadj                  -0.01
heart_diseaseadj                  0.06
ever_marriedadj                  -0.06
work_typeadj                     -0.02
Residence_typeadj                -0.04
avg_glucose_leveladj              0.01
bmiadj                            0.03
smoking_statusadj                 1.00

n= 3357 


P
                     gender age    hypertension heart_disease ever_married
gender                      0.0012 0.0204       0.0000        0.1140      
age                  0.0012        0.0000       0.0000        0.0000      
hypertension         0.0204 0.0000              0.0000        0.0000      
heart_disease        0.0000 0.0000 0.0000                     0.0000      
ever_married         0.1140 0.0000 0.0000       0.0000                    
work_type            0.3863 0.0000 0.0051       0.0862        0.2313      
Residence_type       0.5077 0.3076 0.8569       0.5527        0.5150      
avg_glucose_level    0.0000 0.0000 0.0000       0.0000        0.0000      
bmi                  0.2487 0.0144 0.0000       0.8185        0.0000      
smoking_status       0.0000 0.0448 0.7537       0.0005        0.0009      
stroke               0.4296 0.0000 0.0000       0.0000        0.0002      
genderadj            0.0000 0.0012 0.0204       0.0000        0.1140      
ageadj               0.0012 0.0000 0.0000       0.0000        0.0000      
hypertensionadj      0.0204 0.0000 0.0000       0.0000        0.0000      
heart_diseaseadj     0.0000 0.0000 0.0000       0.0000        0.0000      
ever_marriedadj      0.1140 0.0000 0.0000       0.0000        0.0000      
work_typeadj         0.3863 0.0000 0.0051       0.0862        0.2313      
Residence_typeadj    0.5077 0.3076 0.8569       0.5527        0.5150      
avg_glucose_leveladj 0.0000 0.0000 0.0000       0.0000        0.0000      
bmiadj               0.2487 0.0144 0.0000       0.8185        0.0000      
smoking_statusadj    0.0000 0.0448 0.7537       0.0005        0.0009      
                     work_type Residence_type avg_glucose_level bmi   
gender               0.3863    0.5077         0.0000            0.2487
age                  0.0000    0.3076         0.0000            0.0144
hypertension         0.0051    0.8569         0.0000            0.0000
heart_disease        0.0862    0.5527         0.0000            0.8185
ever_married         0.2313    0.5150         0.0000            0.0000
work_type                      0.6768         0.0467            0.3243
Residence_type       0.6768                   0.6427            0.5689
avg_glucose_level    0.0467    0.6427                           0.0000
bmi                  0.3243    0.5689         0.0000                  
smoking_status       0.3764    0.0208         0.7679            0.0925
stroke               0.0259    0.7171         0.0000            0.6866
genderadj            0.3863    0.5077         0.0000            0.2487
ageadj               0.0000    0.3076         0.0000            0.0144
hypertensionadj      0.0051    0.8569         0.0000            0.0000
heart_diseaseadj     0.0862    0.5527         0.0000            0.8185
ever_marriedadj      0.2313    0.5150         0.0000            0.0000
work_typeadj         0.0000    0.6768         0.0467            0.3243
Residence_typeadj    0.6768    0.0000         0.6427            0.5689
avg_glucose_leveladj 0.0467    0.6427         0.0000            0.0000
bmiadj               0.3243    0.5689         0.0000            0.0000
smoking_statusadj    0.3764    0.0208         0.7679            0.0925
                     smoking_status stroke genderadj ageadj hypertensionadj
gender               0.0000         0.4296 0.0000    0.0012 0.0204         
age                  0.0448         0.0000 0.0012    0.0000 0.0000         
hypertension         0.7537         0.0000 0.0204    0.0000 0.0000         
heart_disease        0.0005         0.0000 0.0000    0.0000 0.0000         
ever_married         0.0009         0.0002 0.1140    0.0000 0.0000         
work_type            0.3764         0.0259 0.3863    0.0000 0.0051         
Residence_type       0.0208         0.7171 0.5077    0.3076 0.8569         
avg_glucose_level    0.7679         0.0000 0.0000    0.0000 0.0000         
bmi                  0.0925         0.6866 0.2487    0.0144 0.0000         
smoking_status                      0.2559 0.0000    0.0448 0.7537         
stroke               0.2559                0.4296    0.0000 0.0000         
genderadj            0.0000         0.4296           0.0012 0.0204         
ageadj               0.0448         0.0000 0.0012           0.0000         
hypertensionadj      0.7537         0.0000 0.0204    0.0000                
heart_diseaseadj     0.0005         0.0000 0.0000    0.0000 0.0000         
ever_marriedadj      0.0009         0.0002 0.1140    0.0000 0.0000         
work_typeadj         0.3764         0.0259 0.3863    0.0000 0.0051         
Residence_typeadj    0.0208         0.7171 0.5077    0.3076 0.8569         
avg_glucose_leveladj 0.7679         0.0000 0.0000    0.0000 0.0000         
bmiadj               0.0925         0.6866 0.2487    0.0144 0.0000         
smoking_statusadj    0.0000         0.2559 0.0000    0.0448 0.7537         
                     heart_diseaseadj ever_marriedadj work_typeadj
gender               0.0000           0.1140          0.3863      
age                  0.0000           0.0000          0.0000      
hypertension         0.0000           0.0000          0.0051      
heart_disease        0.0000           0.0000          0.0862      
ever_married         0.0000           0.0000          0.2313      
work_type            0.0862           0.2313          0.0000      
Residence_type       0.5527           0.5150          0.6768      
avg_glucose_level    0.0000           0.0000          0.0467      
bmi                  0.8185           0.0000          0.3243      
smoking_status       0.0005           0.0009          0.3764      
stroke               0.0000           0.0002          0.0259      
genderadj            0.0000           0.1140          0.3863      
ageadj               0.0000           0.0000          0.0000      
hypertensionadj      0.0000           0.0000          0.0051      
heart_diseaseadj                      0.0000          0.0862      
ever_marriedadj      0.0000                           0.2313      
work_typeadj         0.0862           0.2313                      
Residence_typeadj    0.5527           0.5150          0.6768      
avg_glucose_leveladj 0.0000           0.0000          0.0467      
bmiadj               0.8185           0.0000          0.3243      
smoking_statusadj    0.0005           0.0009          0.3764      
                     Residence_typeadj avg_glucose_leveladj bmiadj
gender               0.5077            0.0000               0.2487
age                  0.3076            0.0000               0.0144
hypertension         0.8569            0.0000               0.0000
heart_disease        0.5527            0.0000               0.8185
ever_married         0.5150            0.0000               0.0000
work_type            0.6768            0.0467               0.3243
Residence_type       0.0000            0.6427               0.5689
avg_glucose_level    0.6427            0.0000               0.0000
bmi                  0.5689            0.0000               0.0000
smoking_status       0.0208            0.7679               0.0925
stroke               0.7171            0.0000               0.6866
genderadj            0.5077            0.0000               0.2487
ageadj               0.3076            0.0000               0.0144
hypertensionadj      0.8569            0.0000               0.0000
heart_diseaseadj     0.5527            0.0000               0.8185
ever_marriedadj      0.5150            0.0000               0.0000
work_typeadj         0.6768            0.0467               0.3243
Residence_typeadj                      0.6427               0.5689
avg_glucose_leveladj 0.6427                                 0.0000
bmiadj               0.5689            0.0000                     
smoking_statusadj    0.0208            0.7679               0.0925
                     smoking_statusadj
gender               0.0000           
age                  0.0448           
hypertension         0.7537           
heart_disease        0.0005           
ever_married         0.0009           
work_type            0.3764           
Residence_type       0.0208           
avg_glucose_level    0.7679           
bmi                  0.0925           
smoking_status       0.0000           
stroke               0.2559           
genderadj            0.0000           
ageadj               0.0448           
hypertensionadj      0.7537           
heart_diseaseadj     0.0005           
ever_marriedadj      0.0009           
work_typeadj         0.3764           
Residence_typeadj    0.0208           
avg_glucose_leveladj 0.7679           
bmiadj               0.0925           
smoking_statusadj                     </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("car")</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="co"># library(car)</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="fu">influencePlot</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Stroke_Results_1019_2025_latest_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>        StudRes          Hat       CookD
83    2.6917353 0.0039267816 0.012237368
84    1.5018344 0.0343771041 0.006641860
87    3.0732709 0.0012042796 0.011476828
131   3.1608870 0.0006013465 0.007697762
152   3.1135601 0.0005613972 0.006237531
2583 -0.8509399 0.0399302730 0.001668526</code></pre>
</div>
</div>
<p>Cooks D ranges from 0 to .0122</p>
<p>While the ideal size is 4/N (4/3357 = 0.012), its far outside the danger zone of .5</p>
<p>Conclusion: Assumption 3 is met - No substantial outliers</p>
</section>
<section id="testing-assumption-4" class="level3">
<h3 class="anchored" data-anchor-id="testing-assumption-4">3.4 Testing Assumption 4</h3>
<p>Testing Assumption 4 : Multicollinearity using vif in the care package</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           gender               age      hypertension     heart_disease 
         1.041499          1.213552          1.051213          1.083661 
     ever_married         work_type    Residence_type avg_glucose_level 
         1.018892          1.051698          1.006965          1.105268 
              bmi    smoking_status 
         1.117138          1.049260 </code></pre>
</div>
</div>
<p>Conclusion. All vif values are below 5 or 10. Ideally most values should be around 1. Range for all</p>
<p>the predictors is between: 1.01 - 1.21. Way below the danger threshold of 5 to 10.</p>
<p>Conclusion: No Multicollinearity</p>
<p>Final Conclusion: All4 assumptions are met, logistic regression is a valid model</p>
</section>
</section>
<section id="analysis-of-the-model" class="level2">
<h2 class="anchored" data-anchor-id="analysis-of-the-model">4 Analysis of the Model</h2>
<p>Part 4: Analysis of the Model</p>
<p>There are 2 issues with the model. Fit and Predictive Capability</p>
<section id="use-hosmer-lemesho-and-naglekerke-r" class="level3">
<h3 class="anchored" data-anchor-id="use-hosmer-lemesho-and-naglekerke-r">4.1 Use Hosmer-lemesho and Naglekerke R</h3>
<p>Part 1 fit. Use Hosmer-lemesho and Naglekerke R for non technical audience</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("ResourceSelection")</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="co"># library(ResourceSelection)</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hoslem.test</span>(model<span class="sc">$</span>y, <span class="fu">fitted</span>(model), <span class="at">g =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Hosmer and Lemeshow goodness of fit (GOF) test

data:  model$y, fitted(model)
X-squared = 5.2704, df = 8, p-value = 0.7283</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("rcompanion")</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="co"># library(rcompanion)</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">nagelkerke</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Models
                                                                                                                                                                               
Model: "glm, stroke ~ gender + age + hypertension + heart_disease + ever_married + work_type + Residence_type + avg_glucose_level + bmi + smoking_status, binomial, LR_stroke1"
Null:  "glm, stroke ~ 1, binomial, LR_stroke1"                                                                                                                                 

$Pseudo.R.squared.for.model.vs.null
                             Pseudo.R.squared
McFadden                            0.1838790
Cox and Snell (ML)                  0.0739944
Nagelkerke (Cragg and Uhler)        0.2165560

$Likelihood.ratio.test
 Df.diff LogLik.diff  Chisq    p.value
     -10     -129.03 258.07 1.0892e-49

$Number.of.observations
           
Model: 3357
Null:  3357

$Messages
[1] "Note: For models fit with REML, these statistics are based on refitting with ML"

$Warnings
[1] "None"</code></pre>
</div>
</div>
</section>
<section id="predictive-capability" class="level3">
<h3 class="anchored" data-anchor-id="predictive-capability">4.2 Predictive Capability</h3>
<p>Part 2 - Predictive Capability</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("pROC")</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="co"># library(pROC)</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>probs <span class="ot">&lt;-</span> <span class="fu">predict</span>(model, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">roc</span>(LR_stroke1<span class="sc">$</span>stroke, probs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Setting levels: control = 0, case = 1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Setting direction: controls &lt; cases</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">auc</span>(roc_obj)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Area under the curve: 0.8285</code></pre>
</div>
</div>
<p>Predict AUC cross validation</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Need to implement AUC cross validation
</div>
</div>
<div class="callout-body-container callout-body">
<p>Could not understand yet how to implement the AUC cross validation</p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict AUC cross validation</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("cvAUC")</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="co"># library(cvAUC)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Confusion Matrix</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Confusion Matrix</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>LR_stroke1<span class="sc">$</span>gender <span class="ot">&lt;-</span> <span class="fu">factor</span>(LR_stroke1<span class="sc">$</span>gender)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>LR_stroke1<span class="sc">$</span>hypertension <span class="ot">&lt;-</span> <span class="fu">factor</span>(LR_stroke1<span class="sc">$</span>hypertension)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>LR_stroke1<span class="sc">$</span>heart_disease <span class="ot">&lt;-</span> <span class="fu">factor</span>(LR_stroke1<span class="sc">$</span>heart_disease)</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>LR_stroke1<span class="sc">$</span>ever_married <span class="ot">&lt;-</span> <span class="fu">factor</span>(LR_stroke1<span class="sc">$</span>ever_married)</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>LR_stroke1<span class="sc">$</span>work_type <span class="ot">&lt;-</span> <span class="fu">factor</span>(LR_stroke1<span class="sc">$</span>work_type)</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>LR_stroke1<span class="sc">$</span>Residence_type <span class="ot">&lt;-</span> <span class="fu">factor</span>(LR_stroke1<span class="sc">$</span>Residence_type)</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>LR_stroke1<span class="sc">$</span>smoking_status <span class="ot">&lt;-</span> <span class="fu">factor</span>(LR_stroke1<span class="sc">$</span>smoking_status)</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>LR_stroke1<span class="sc">$</span>stroke <span class="ot">&lt;-</span> <span class="fu">factor</span>(LR_stroke1<span class="sc">$</span>stroke)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>fit logistic regression model</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit logistic regression model</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>model_CM <span class="ot">&lt;-</span> <span class="fu">glm</span>(stroke <span class="sc">~</span> gender <span class="sc">+</span> age <span class="sc">+</span> hypertension <span class="sc">+</span> heart_disease <span class="sc">+</span> ever_married <span class="sc">+</span> work_type <span class="sc">+</span> Residence_type <span class="sc">+</span> avg_glucose_level <span class="sc">+</span> bmi <span class="sc">+</span> smoking_status, <span class="at">data=</span>LR_stroke1, <span class="at">family =</span> binomial)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Get Predicted Probabilities for each observation</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get Predicted Probabilities for each observation</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>pred_prob <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_CM, <span class="at">type =</span> <span class="st">"response"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>create 10 confusion matrices at threshold intervals between 1 and 0 to create a ROC</p>
<p>Classify prediction using a threshold (0.5 is common but can adjust)</p>
<p>IF 1 row is all 0’s then model doesn’t show any predictability</p>
<p><strong>At threshold of around 1.0</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create 10 confusion matrices at threshold intervals between 1 and 0 to create a ROC</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Classify prediction using a threshold (0.5 is common but can adjust)</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="co"># IF 1 row is all 0's then model doesn't show any predictability</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="co"># At threshold of around 1.0</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>pred_class <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">ifelse</span>(pred_prob <span class="sc">&gt;</span> .<span class="dv">99</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>conf_matrix <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_class, <span class="fu">factor</span>(LR_stroke1<span class="sc">$</span>stroke, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"0"</span>, <span class="st">"1"</span>)), <span class="at">positive =</span> <span class="st">"1"</span>)</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(conf_matrix<span class="sc">$</span>table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Reference
Prediction    0    1
         0 3177  180
         1    0    0</code></pre>
</div>
</div>
<p>IF 1 row is all 0’s then model doesn’t show any predictability</p>
<p><strong>At threshold of 0.9</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># At threshold of 0.9</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>pred_class <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">ifelse</span>(pred_prob <span class="sc">&gt;</span> <span class="fl">0.9</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>conf_matrix <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_class, <span class="fu">factor</span>(LR_stroke1<span class="sc">$</span>stroke, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"0"</span>, <span class="st">"1"</span>)), <span class="at">positive =</span> <span class="st">"1"</span>)</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(conf_matrix<span class="sc">$</span>table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Reference
Prediction    0    1
         0 3177  180
         1    0    0</code></pre>
</div>
</div>
<p>IF 1 row is all 0’s then model doesn’t show any predictability</p>
<p><strong>At threshold of 0.8</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># At threshold of 0.8</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>pred_class <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">ifelse</span>(pred_prob <span class="sc">&gt;</span> <span class="fl">0.8</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>conf_matrix <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_class, <span class="fu">factor</span>(LR_stroke1<span class="sc">$</span>stroke, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"0"</span>, <span class="st">"1"</span>)), <span class="at">positive =</span> <span class="st">"1"</span>)</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(conf_matrix<span class="sc">$</span>table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Reference
Prediction    0    1
         0 3177  180
         1    0    0</code></pre>
</div>
</div>
<p>IF 1 row is all 0’s then model doesn’t show any predictability</p>
<p><strong>At threshold of 0.7</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># At threshold of 0.7</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>pred_class <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">ifelse</span>(pred_prob <span class="sc">&gt;</span> <span class="fl">0.7</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>conf_matrix <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_class, <span class="fu">factor</span>(LR_stroke1<span class="sc">$</span>stroke, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"0"</span>, <span class="st">"1"</span>)), <span class="at">positive =</span> <span class="st">"1"</span>)</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(conf_matrix<span class="sc">$</span>table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Reference
Prediction    0    1
         0 3177  180
         1    0    0</code></pre>
</div>
</div>
<p><strong>At threshold of 0.6</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># At threshold of 0.6</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>pred_class <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">ifelse</span>(pred_prob <span class="sc">&gt;</span> <span class="fl">0.6</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>conf_matrix <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_class, <span class="fu">factor</span>(LR_stroke1<span class="sc">$</span>stroke, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"0"</span>, <span class="st">"1"</span>)), <span class="at">positive =</span> <span class="st">"1"</span>)</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(conf_matrix<span class="sc">$</span>table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Reference
Prediction    0    1
         0 3177  179
         1    0    1</code></pre>
</div>
</div>
<p>at threshold of 0.6 that starts the models predictability</p>
<p>Extract precision,Recall and F1 from confusion matrix using the caret package</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract precision, Recall and F1 from confusion matrix using the caret package</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> conf_matrix<span class="sc">$</span>byClass[<span class="st">"Pos Pred Value"</span>] </span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>recall <span class="ot">&lt;-</span> conf_matrix<span class="sc">$</span>byClass[<span class="st">"Sensitivity"</span>]</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> ((precision <span class="sc">*</span> recall)<span class="sc">/</span> (precision <span class="sc">+</span> recall))</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">sprintf</span>(<span class="st">"F1: %f"</span>, f1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "F1: 0.011050"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">sprintf</span>(<span class="st">"recall: %f"</span>, recall))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "recall: 0.005556"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">sprintf</span>(<span class="st">"precision: %f"</span>, precision))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "precision: 1.000000"</code></pre>
</div>
</div>
<p><strong>at threshold of 0.5</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># at threshold of 0.5</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>pred_class <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">ifelse</span>(pred_prob <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>conf_matrix <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_class, <span class="fu">factor</span>(LR_stroke1<span class="sc">$</span>stroke, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"0"</span>, <span class="st">"1"</span>)), <span class="at">positive =</span> <span class="st">"1"</span>)</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(conf_matrix<span class="sc">$</span>table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Reference
Prediction    0    1
         0 3176  179
         1    1    1</code></pre>
</div>
</div>
<p>Extract precision,Recall and F1 from confusion matrix using the caret package</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract precision,Recall and F1 from confusion matrix using the caret package</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> conf_matrix<span class="sc">$</span>byClass[<span class="st">"Pos Pred Value"</span>] </span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>recall <span class="ot">&lt;-</span> conf_matrix<span class="sc">$</span>byClass[<span class="st">"Sensitivity"</span>]</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> ((precision <span class="sc">*</span> recall)<span class="sc">/</span> (precision <span class="sc">+</span> recall))</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">sprintf</span>(<span class="st">"F1: %f"</span>, f1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "F1: 0.010989"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">sprintf</span>(<span class="st">"recall: %f"</span>, recall))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "recall: 0.005556"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">sprintf</span>(<span class="st">"precision: %f"</span>, precision))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "precision: 0.500000"</code></pre>
</div>
</div>
<p><strong>At threshold of 0.4</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># At threshold of 0.4</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>pred_class <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">ifelse</span>(pred_prob <span class="sc">&gt;</span> <span class="fl">0.4</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>conf_matrix <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_class, <span class="fu">factor</span>(LR_stroke1<span class="sc">$</span>stroke, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"0"</span>, <span class="st">"1"</span>)), <span class="at">positive =</span> <span class="st">"1"</span>)</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(conf_matrix<span class="sc">$</span>table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Reference
Prediction    0    1
         0 3171  174
         1    6    6</code></pre>
</div>
</div>
<p>Extract precision,Recall and F1 from confusion matrix using the caret package</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract precision,Recall and F1 from confusion matrix using the caret package</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> conf_matrix<span class="sc">$</span>byClass[<span class="st">"Pos Pred Value"</span>] </span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>recall <span class="ot">&lt;-</span> conf_matrix<span class="sc">$</span>byClass[<span class="st">"Sensitivity"</span>]</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> ((precision <span class="sc">*</span> recall)<span class="sc">/</span> (precision <span class="sc">+</span> recall))</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">sprintf</span>(<span class="st">"F1: %f"</span>, f1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "F1: 0.062500"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">sprintf</span>(<span class="st">"recall: %f"</span>, recall))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "recall: 0.033333"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">sprintf</span>(<span class="st">"precision: %f"</span>, precision))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "precision: 0.500000"</code></pre>
</div>
</div>
<p><strong>at threshold of 0.3</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># at threshold of 0.3</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>pred_class <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">ifelse</span>(pred_prob <span class="sc">&gt;</span> <span class="fl">0.3</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>conf_matrix <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_class, <span class="fu">factor</span>(LR_stroke1<span class="sc">$</span>stroke, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"0"</span>, <span class="st">"1"</span>)), <span class="at">positive =</span> <span class="st">"1"</span>)</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(conf_matrix<span class="sc">$</span>table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Reference
Prediction    0    1
         0 3140  164
         1   37   16</code></pre>
</div>
</div>
<p>Extract precision,Recall and F1 from confusion matrix using the caret package</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract precision,Recall and F1 from confusion matrix using the caret package</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> conf_matrix<span class="sc">$</span>byClass[<span class="st">"Pos Pred Value"</span>] </span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>recall <span class="ot">&lt;-</span> conf_matrix<span class="sc">$</span>byClass[<span class="st">"Sensitivity"</span>]</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> ((precision <span class="sc">*</span> recall)<span class="sc">/</span> (precision <span class="sc">+</span> recall))</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">sprintf</span>(<span class="st">"F1: %f"</span>, f1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "F1: 0.137339"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">sprintf</span>(<span class="st">"recall: %f"</span>, recall))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "recall: 0.088889"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">sprintf</span>(<span class="st">"precision: %f"</span>, precision))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "precision: 0.301887"</code></pre>
</div>
</div>
<p><strong>at threshold of 0.2</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># at threshold of 0.2</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>pred_class <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">ifelse</span>(pred_prob <span class="sc">&gt;</span> <span class="fl">0.2</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>conf_matrix <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_class, <span class="fu">factor</span>(LR_stroke1<span class="sc">$</span>stroke, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"0"</span>, <span class="st">"1"</span>)), <span class="at">positive =</span> <span class="st">"1"</span>)</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(conf_matrix<span class="sc">$</span>table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Reference
Prediction    0    1
         0 3040  134
         1  137   46</code></pre>
</div>
</div>
<p>Extract precision,Recall and F1 from confusion matrix using the caret package</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract precision,Recall and F1 from confusion matrix using the caret package</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> conf_matrix<span class="sc">$</span>byClass[<span class="st">"Pos Pred Value"</span>] </span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>recall <span class="ot">&lt;-</span> conf_matrix<span class="sc">$</span>byClass[<span class="st">"Sensitivity"</span>]</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> ((precision <span class="sc">*</span> recall)<span class="sc">/</span> (precision <span class="sc">+</span> recall))</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">sprintf</span>(<span class="st">"F1: %f"</span>, f1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "F1: 0.253444"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">sprintf</span>(<span class="st">"recall: %f"</span>, recall))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "recall: 0.255556"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">sprintf</span>(<span class="st">"precision: %f"</span>, precision))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "precision: 0.251366"</code></pre>
</div>
</div>
<p>Using the different Confusion Matrices, Create the ROC curve</p>
</section>
</section>
<section id="original-code" class="level2">
<h2 class="anchored" data-anchor-id="original-code">Original Code</h2>
<p>Below we see the Original Code shared by Steve: <strong>Stroke_Results_1019_2025_latest_440PM_SW_For_Group.R</strong></p>
<div class="sourceCode" id="cb91"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"dplyr"</span>)</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"car"</span>)</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"ResourceSelection"</span>)</span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"caret"</span>)</span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"car"</span>)</span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ResourceSelection)</span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a>stroke1 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"D:</span><span class="sc">\\</span><span class="st">stroke.csv"</span>)</span>
<span id="cb91-13"><a href="#cb91-13" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(stroke1)</span>
<span id="cb91-14"><a href="#cb91-14" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(stroke1)</span>
<span id="cb91-15"><a href="#cb91-15" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(stroke1)</span>
<span id="cb91-16"><a href="#cb91-16" aria-hidden="true" tabindex="-1"></a>count_tables <span class="ot">&lt;-</span> <span class="fu">lapply</span>(stroke1, table)</span>
<span id="cb91-17"><a href="#cb91-17" aria-hidden="true" tabindex="-1"></a>count_tables</span>
<span id="cb91-18"><a href="#cb91-18" aria-hidden="true" tabindex="-1"></a><span class="co">#-------------------------------------------Part 1:  preparing the data---------------------------------#</span></span>
<span id="cb91-19"><a href="#cb91-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Smoking Status - remove unknown#</span></span>
<span id="cb91-20"><a href="#cb91-20" aria-hidden="true" tabindex="-1"></a><span class="co">#bmi - remove N/A#</span></span>
<span id="cb91-21"><a href="#cb91-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Work type - remove children#</span></span>
<span id="cb91-22"><a href="#cb91-22" aria-hidden="true" tabindex="-1"></a><span class="co"># age create numerical variable with 2 places after the decimal#</span></span>
<span id="cb91-23"><a href="#cb91-23" aria-hidden="true" tabindex="-1"></a><span class="co">#gender -remove other#</span></span>
<span id="cb91-24"><a href="#cb91-24" aria-hidden="true" tabindex="-1"></a>stroke1[stroke1 <span class="sc">==</span> <span class="st">"N/A"</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb91-25"><a href="#cb91-25" aria-hidden="true" tabindex="-1"></a>stroke1[stroke1 <span class="sc">==</span> <span class="st">"Unknown"</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb91-26"><a href="#cb91-26" aria-hidden="true" tabindex="-1"></a>stroke1[stroke1 <span class="sc">==</span> <span class="st">"children"</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb91-27"><a href="#cb91-27" aria-hidden="true" tabindex="-1"></a>stroke1[stroke1 <span class="sc">==</span> <span class="st">"other"</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb91-28"><a href="#cb91-28" aria-hidden="true" tabindex="-1"></a>stroke1<span class="sc">$</span>bmi <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(stroke1<span class="sc">$</span>bmi), <span class="dv">2</span>)</span>
<span id="cb91-29"><a href="#cb91-29" aria-hidden="true" tabindex="-1"></a>stroke1<span class="sc">$</span>gender[stroke1<span class="sc">$</span>gender <span class="sc">==</span> <span class="st">"Male"</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb91-30"><a href="#cb91-30" aria-hidden="true" tabindex="-1"></a>stroke1<span class="sc">$</span>gender[stroke1<span class="sc">$</span>gender <span class="sc">==</span> <span class="st">"Female"</span>] <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb91-31"><a href="#cb91-31" aria-hidden="true" tabindex="-1"></a>stroke1<span class="sc">$</span>gender <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(stroke1<span class="sc">$</span>gender)</span>
<span id="cb91-32"><a href="#cb91-32" aria-hidden="true" tabindex="-1"></a>stroke1<span class="sc">$</span>ever_married[stroke1<span class="sc">$</span>ever_married <span class="sc">==</span> <span class="st">"Yes"</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb91-33"><a href="#cb91-33" aria-hidden="true" tabindex="-1"></a>stroke1<span class="sc">$</span>ever_married[stroke1<span class="sc">$</span>ever_married <span class="sc">==</span> <span class="st">"No"</span>] <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb91-34"><a href="#cb91-34" aria-hidden="true" tabindex="-1"></a>stroke1<span class="sc">$</span>ever_married <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(stroke1<span class="sc">$</span>ever_married)</span>
<span id="cb91-35"><a href="#cb91-35" aria-hidden="true" tabindex="-1"></a>stroke1<span class="sc">$</span>work_type[stroke1<span class="sc">$</span>work_type <span class="sc">==</span> <span class="st">"Govt_job"</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb91-36"><a href="#cb91-36" aria-hidden="true" tabindex="-1"></a>stroke1<span class="sc">$</span>work_type[stroke1<span class="sc">$</span>work_type <span class="sc">==</span> <span class="st">"Private"</span>] <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb91-37"><a href="#cb91-37" aria-hidden="true" tabindex="-1"></a>stroke1<span class="sc">$</span>work_type[stroke1<span class="sc">$</span>work_type <span class="sc">==</span> <span class="st">"Self-employed"</span>] <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb91-38"><a href="#cb91-38" aria-hidden="true" tabindex="-1"></a>stroke1<span class="sc">$</span>work_type[stroke1<span class="sc">$</span>work_type <span class="sc">==</span> <span class="st">"Never_worked"</span>] <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb91-39"><a href="#cb91-39" aria-hidden="true" tabindex="-1"></a>stroke1<span class="sc">$</span>work_type <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(stroke1<span class="sc">$</span>work_type)</span>
<span id="cb91-40"><a href="#cb91-40" aria-hidden="true" tabindex="-1"></a>stroke1<span class="sc">$</span>Residence_type[stroke1<span class="sc">$</span>Residence_type <span class="sc">==</span> <span class="st">"Urban"</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb91-41"><a href="#cb91-41" aria-hidden="true" tabindex="-1"></a>stroke1<span class="sc">$</span>Residence_type[stroke1<span class="sc">$</span>Residence_type <span class="sc">==</span> <span class="st">"Rural"</span>] <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb91-42"><a href="#cb91-42" aria-hidden="true" tabindex="-1"></a>stroke1<span class="sc">$</span>Residence_type <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(stroke1<span class="sc">$</span>Residence_type)</span>
<span id="cb91-43"><a href="#cb91-43" aria-hidden="true" tabindex="-1"></a>stroke1<span class="sc">$</span>avg_glucose_level <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(stroke1<span class="sc">$</span>avg_glucose_level)</span>
<span id="cb91-44"><a href="#cb91-44" aria-hidden="true" tabindex="-1"></a>stroke1<span class="sc">$</span>heart_disease <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(stroke1<span class="sc">$</span>heart_disease)</span>
<span id="cb91-45"><a href="#cb91-45" aria-hidden="true" tabindex="-1"></a>stroke1<span class="sc">$</span>hypertension <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(stroke1<span class="sc">$</span>hypertension)</span>
<span id="cb91-46"><a href="#cb91-46" aria-hidden="true" tabindex="-1"></a>stroke1<span class="sc">$</span>age <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(stroke1<span class="sc">$</span>age), <span class="dv">2</span>)</span>
<span id="cb91-47"><a href="#cb91-47" aria-hidden="true" tabindex="-1"></a>stroke1<span class="sc">$</span>stroke <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(stroke1<span class="sc">$</span>stroke)</span>
<span id="cb91-48"><a href="#cb91-48" aria-hidden="true" tabindex="-1"></a>stroke1<span class="sc">$</span>smoking_status[stroke1<span class="sc">$</span>smoking_status <span class="sc">==</span> <span class="st">"never smoked"</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb91-49"><a href="#cb91-49" aria-hidden="true" tabindex="-1"></a>stroke1<span class="sc">$</span>smoking_status[stroke1<span class="sc">$</span>smoking_status <span class="sc">==</span> <span class="st">"formerly smoked"</span>] <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb91-50"><a href="#cb91-50" aria-hidden="true" tabindex="-1"></a>stroke1<span class="sc">$</span>smoking_status[stroke1<span class="sc">$</span>smoking_status <span class="sc">==</span> <span class="st">"smokes"</span>] <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb91-51"><a href="#cb91-51" aria-hidden="true" tabindex="-1"></a>stroke1<span class="sc">$</span>smoking_status <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(stroke1<span class="sc">$</span>smoking_status)</span>
<span id="cb91-52"><a href="#cb91-52" aria-hidden="true" tabindex="-1"></a>stroke1 <span class="ot">&lt;-</span> stroke1[, <span class="sc">!</span>(<span class="fu">names</span>(stroke1) <span class="sc">%in%</span> <span class="st">"id"</span>)]</span>
<span id="cb91-53"><a href="#cb91-53" aria-hidden="true" tabindex="-1"></a>stroke1_clean <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(stroke1)</span>
<span id="cb91-54"><a href="#cb91-54" aria-hidden="true" tabindex="-1"></a><span class="co">#converted all columns to numeric and removed id#</span></span>
<span id="cb91-55"><a href="#cb91-55" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(stroke1_clean)</span>
<span id="cb91-56"><a href="#cb91-56" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(stroke1_clean)</span>
<span id="cb91-57"><a href="#cb91-57" aria-hidden="true" tabindex="-1"></a>LR_stroke1 <span class="ot">&lt;-</span> stroke1_clean</span>
<span id="cb91-58"><a href="#cb91-58" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(LR_stroke1)</span>
<span id="cb91-59"><a href="#cb91-59" aria-hidden="true" tabindex="-1"></a>count_tables <span class="ot">&lt;-</span> <span class="fu">lapply</span>(LR_stroke1, table)</span>
<span id="cb91-60"><a href="#cb91-60" aria-hidden="true" tabindex="-1"></a>count_tables</span>
<span id="cb91-61"><a href="#cb91-61" aria-hidden="true" tabindex="-1"></a><span class="co">#-------------------------Part 2:Create and Run the Logistic Regression model from the  dataset-------------#</span></span>
<span id="cb91-62"><a href="#cb91-62" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">glm</span>(stroke <span class="sc">~</span> gender <span class="sc">+</span> age <span class="sc">+</span> hypertension <span class="sc">+</span> heart_disease <span class="sc">+</span> ever_married <span class="sc">+</span> work_type <span class="sc">+</span> Residence_type <span class="sc">+</span> avg_glucose_level <span class="sc">+</span> bmi <span class="sc">+</span> smoking_status, <span class="at">data=</span>LR_stroke1, <span class="at">family =</span> binomial)</span>
<span id="cb91-63"><a href="#cb91-63" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span>
<span id="cb91-64"><a href="#cb91-64" aria-hidden="true" tabindex="-1"></a><span class="co"># ----------------------------------------------Issue _ Unbalanced Data set--------------------------------------#</span></span>
<span id="cb91-65"><a href="#cb91-65" aria-hidden="true" tabindex="-1"></a><span class="co"># The stroke rate = 180/3357 = 054%. But the stroke rate in the US is 3.1% by the CDC, AHA, and the NCHS.--------#</span></span>
<span id="cb91-66"><a href="#cb91-66" aria-hidden="true" tabindex="-1"></a><span class="co"># The dataset is oversampling stroke rate by 77%. We can either SMOTE, under/over sample....but too much time----#</span></span>
<span id="cb91-67"><a href="#cb91-67" aria-hidden="true" tabindex="-1"></a><span class="co"># Best way is to recalibrate the intercept for this model (Ie change it here) so it can be used from now on------#</span></span>
<span id="cb91-68"><a href="#cb91-68" aria-hidden="true" tabindex="-1"></a>ds_prev <span class="ot">&lt;-</span> .<span class="dv">054</span></span>
<span id="cb91-69"><a href="#cb91-69" aria-hidden="true" tabindex="-1"></a>pop_prev <span class="ot">&lt;-</span> .<span class="dv">031</span></span>
<span id="cb91-70"><a href="#cb91-70" aria-hidden="true" tabindex="-1"></a>log_odds_ds <span class="ot">&lt;-</span> <span class="fu">qlogis</span>(ds_prev)</span>
<span id="cb91-71"><a href="#cb91-71" aria-hidden="true" tabindex="-1"></a>log_odds_pop <span class="ot">&lt;-</span> <span class="fu">qlogis</span>(pop_prev)</span>
<span id="cb91-72"><a href="#cb91-72" aria-hidden="true" tabindex="-1"></a>offset <span class="ot">&lt;-</span> log_odds_pop <span class="sc">-</span> log_odds_ds</span>
<span id="cb91-73"><a href="#cb91-73" aria-hidden="true" tabindex="-1"></a>coefs <span class="ot">&lt;-</span> <span class="fu">coef</span>(model)</span>
<span id="cb91-74"><a href="#cb91-74" aria-hidden="true" tabindex="-1"></a>coefs[<span class="dv">1</span>] <span class="ot">&lt;-</span> coefs[<span class="dv">1</span>] <span class="sc">+</span> offset</span>
<span id="cb91-75"><a href="#cb91-75" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(coefs)</span>
<span id="cb91-76"><a href="#cb91-76" aria-hidden="true" tabindex="-1"></a><span class="co"># Original Intercept Coeff = -8.426854231#</span></span>
<span id="cb91-77"><a href="#cb91-77" aria-hidden="true" tabindex="-1"></a><span class="co"># Changed intercept Coefficent to take into account current stroke rate or 3.1% = -9.005873116-------------------#</span></span>
<span id="cb91-78"><a href="#cb91-78" aria-hidden="true" tabindex="-1"></a><span class="co"># all the other intercepts remain the same-----------------------------------------------------------------------#</span></span>
<span id="cb91-79"><a href="#cb91-79" aria-hidden="true" tabindex="-1"></a><span class="co"># ----------------------------------Part 3: Testing logistic Regression Model Assumptions------------------------#</span></span>
<span id="cb91-80"><a href="#cb91-80" aria-hidden="true" tabindex="-1"></a><span class="co"># There are several assumptions for Logistic Regression#</span></span>
<span id="cb91-81"><a href="#cb91-81" aria-hidden="true" tabindex="-1"></a><span class="co"># They are:#</span></span>
<span id="cb91-82"><a href="#cb91-82" aria-hidden="true" tabindex="-1"></a><span class="co">#(1) The Dependent Variable is binary (i.e, 0 or 1)#</span></span>
<span id="cb91-83"><a href="#cb91-83" aria-hidden="true" tabindex="-1"></a><span class="co">#(2) There is a linear relationship between th logit of the outcome and each predictor#</span></span>
<span id="cb91-84"><a href="#cb91-84" aria-hidden="true" tabindex="-1"></a><span class="co">#(3) There are NO high leverage outliers in the predictors#</span></span>
<span id="cb91-85"><a href="#cb91-85" aria-hidden="true" tabindex="-1"></a><span class="co">#(4) There is No high multicollinearity (ie strong correlations) between predictors#</span></span>
<span id="cb91-86"><a href="#cb91-86" aria-hidden="true" tabindex="-1"></a><span class="do">####################################:Now to test each assumption: ################</span></span>
<span id="cb91-87"><a href="#cb91-87" aria-hidden="true" tabindex="-1"></a><span class="co"># Testing Assumption 1: The Dependent Variable is binary (0 or 1)#</span></span>
<span id="cb91-88"><a href="#cb91-88" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(LR_stroke1<span class="sc">$</span>stroke)</span>
<span id="cb91-89"><a href="#cb91-89" aria-hidden="true" tabindex="-1"></a><span class="co">#Testing Assumption 2: There is a linear relationship between the outcome variable and each predictor</span></span>
<span id="cb91-90"><a href="#cb91-90" aria-hidden="true" tabindex="-1"></a><span class="co">#first,  adjust all predictors so all values are positive#</span></span>
<span id="cb91-91"><a href="#cb91-91" aria-hidden="true" tabindex="-1"></a><span class="co"># Conclusion: For all continuous variables , ageadj, avg_glucose_leveladj, and bniadj, the residual plots show linearity#</span></span>
<span id="cb91-92"><a href="#cb91-92" aria-hidden="true" tabindex="-1"></a><span class="co"># Conclusion:all the other predictors are categorical, with the magenta line flat, and the values clustering around certain values, they are also appropriate for logistic regression#</span></span>
<span id="cb91-93"><a href="#cb91-93" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------------------------------Conclusion for assumption 2 - Linearity is met--------------------------------#</span></span>
<span id="cb91-94"><a href="#cb91-94" aria-hidden="true" tabindex="-1"></a><span class="co"># Testing Assumption 3: assess influential outliers using car package and influencePlot#</span></span>
<span id="cb91-95"><a href="#cb91-95" aria-hidden="true" tabindex="-1"></a><span class="fu">alias</span>(model)</span>
<span id="cb91-96"><a href="#cb91-96" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"Hmisc"</span>)</span>
<span id="cb91-97"><a href="#cb91-97" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Hmisc)</span>
<span id="cb91-98"><a href="#cb91-98" aria-hidden="true" tabindex="-1"></a><span class="fu">rcorr</span>(<span class="fu">as.matrix</span>(LR_stroke1))</span>
<span id="cb91-99"><a href="#cb91-99" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"car"</span>)</span>
<span id="cb91-100"><a href="#cb91-100" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb91-101"><a href="#cb91-101" aria-hidden="true" tabindex="-1"></a><span class="fu">influencePlot</span>(model)</span>
<span id="cb91-102"><a href="#cb91-102" aria-hidden="true" tabindex="-1"></a><span class="co"># Cooks D ranges from 0 to .0122 While the ideal size is 4/N (4/3357 = 0.012), its far outside the danger zone of .5</span></span>
<span id="cb91-103"><a href="#cb91-103" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------------------- Conclusion: Assumption 3 is met - No substantial outliers---------------------#</span></span>
<span id="cb91-104"><a href="#cb91-104" aria-hidden="true" tabindex="-1"></a><span class="co"># Testing Assumption 4 : Multicollinearity using vif in the care package#</span></span>
<span id="cb91-105"><a href="#cb91-105" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(model)</span>
<span id="cb91-106"><a href="#cb91-106" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------Conclusion. All vif values are below  5 or 10. Ideally most values should be around 1. Range for all#</span></span>
<span id="cb91-107"><a href="#cb91-107" aria-hidden="true" tabindex="-1"></a><span class="co"># the predictors is between: 1.01 - 1.21. Way below the danger threshold of 5 to 10. Conclusion: No Multicollinearity####</span></span>
<span id="cb91-108"><a href="#cb91-108" aria-hidden="true" tabindex="-1"></a><span class="do">#####################################################################################################################</span></span>
<span id="cb91-109"><a href="#cb91-109" aria-hidden="true" tabindex="-1"></a><span class="co"># -----------------Final Conclusion: All4 assumptions are met, logistic regression is a valid model---------------#</span></span>
<span id="cb91-110"><a href="#cb91-110" aria-hidden="true" tabindex="-1"></a><span class="do">####################################################################################################################</span></span>
<span id="cb91-111"><a href="#cb91-111" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------------------------------------Part 4: Analysis of the Model----------------------------------------#</span></span>
<span id="cb91-112"><a href="#cb91-112" aria-hidden="true" tabindex="-1"></a><span class="co"># -----------------------There are 2 issues with the model. Fit and Predictive Capability---------------------------#</span></span>
<span id="cb91-113"><a href="#cb91-113" aria-hidden="true" tabindex="-1"></a><span class="co"># ----------------Part 1  fit. Use Hosmer-lemesho and Naglekerke R for non technical audience-----------------------#</span></span>
<span id="cb91-114"><a href="#cb91-114" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"ResourceSelection"</span>)</span>
<span id="cb91-115"><a href="#cb91-115" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ResourceSelection)</span>
<span id="cb91-116"><a href="#cb91-116" aria-hidden="true" tabindex="-1"></a><span class="fu">hoslem.test</span>(model<span class="sc">$</span>y, <span class="fu">fitted</span>(model), <span class="at">g =</span> <span class="dv">10</span>)</span>
<span id="cb91-117"><a href="#cb91-117" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"rcompanion"</span>)</span>
<span id="cb91-118"><a href="#cb91-118" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rcompanion)</span>
<span id="cb91-119"><a href="#cb91-119" aria-hidden="true" tabindex="-1"></a><span class="fu">nagelkerke</span>(model)</span>
<span id="cb91-120"><a href="#cb91-120" aria-hidden="true" tabindex="-1"></a><span class="co"># -----------------------Part 2 - Predictive Capability-----------------------------------------------------------</span></span>
<span id="cb91-121"><a href="#cb91-121" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"pROC"</span>)</span>
<span id="cb91-122"><a href="#cb91-122" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pROC)</span>
<span id="cb91-123"><a href="#cb91-123" aria-hidden="true" tabindex="-1"></a>probs <span class="ot">&lt;-</span> <span class="fu">predict</span>(model, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb91-124"><a href="#cb91-124" aria-hidden="true" tabindex="-1"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">roc</span>(LR_stroke1<span class="sc">$</span>stroke, probs)</span>
<span id="cb91-125"><a href="#cb91-125" aria-hidden="true" tabindex="-1"></a><span class="fu">auc</span>(roc_obj)</span>
<span id="cb91-126"><a href="#cb91-126" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict AUC cross validation</span></span>
<span id="cb91-127"><a href="#cb91-127" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"cvAUC"</span>)</span>
<span id="cb91-128"><a href="#cb91-128" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cvAUC)</span>
<span id="cb91-129"><a href="#cb91-129" aria-hidden="true" tabindex="-1"></a><span class="co"># Confusion Matrix</span></span>
<span id="cb91-130"><a href="#cb91-130" aria-hidden="true" tabindex="-1"></a>LR_stroke1<span class="sc">$</span>gender <span class="ot">&lt;-</span> <span class="fu">factor</span>(LR_stroke1<span class="sc">$</span>gender)</span>
<span id="cb91-131"><a href="#cb91-131" aria-hidden="true" tabindex="-1"></a>LR_stroke1<span class="sc">$</span>hypertension <span class="ot">&lt;-</span> <span class="fu">factor</span>(LR_stroke1<span class="sc">$</span>hypertension)</span>
<span id="cb91-132"><a href="#cb91-132" aria-hidden="true" tabindex="-1"></a>LR_stroke1<span class="sc">$</span>heart_disease <span class="ot">&lt;-</span> <span class="fu">factor</span>(LR_stroke1<span class="sc">$</span>heart_disease)</span>
<span id="cb91-133"><a href="#cb91-133" aria-hidden="true" tabindex="-1"></a>LR_stroke1<span class="sc">$</span>ever_married <span class="ot">&lt;-</span> <span class="fu">factor</span>(LR_stroke1<span class="sc">$</span>ever_married)</span>
<span id="cb91-134"><a href="#cb91-134" aria-hidden="true" tabindex="-1"></a>LR_stroke1<span class="sc">$</span>work_type <span class="ot">&lt;-</span> <span class="fu">factor</span>(LR_stroke1<span class="sc">$</span>work_type)</span>
<span id="cb91-135"><a href="#cb91-135" aria-hidden="true" tabindex="-1"></a>LR_stroke1<span class="sc">$</span>Residence_type <span class="ot">&lt;-</span> <span class="fu">factor</span>(LR_stroke1<span class="sc">$</span>Residence_type)</span>
<span id="cb91-136"><a href="#cb91-136" aria-hidden="true" tabindex="-1"></a>LR_stroke1<span class="sc">$</span>smoking_status <span class="ot">&lt;-</span> <span class="fu">factor</span>(LR_stroke1<span class="sc">$</span>smoking_status)</span>
<span id="cb91-137"><a href="#cb91-137" aria-hidden="true" tabindex="-1"></a>LR_stroke1<span class="sc">$</span>stroke <span class="ot">&lt;-</span> <span class="fu">factor</span>(LR_stroke1<span class="sc">$</span>stroke)</span>
<span id="cb91-138"><a href="#cb91-138" aria-hidden="true" tabindex="-1"></a><span class="co"># fit logistic regression model</span></span>
<span id="cb91-139"><a href="#cb91-139" aria-hidden="true" tabindex="-1"></a>model_CM <span class="ot">&lt;-</span> <span class="fu">glm</span>(stroke <span class="sc">~</span> gender <span class="sc">+</span> age <span class="sc">+</span> hypertension <span class="sc">+</span> heart_disease <span class="sc">+</span> ever_married <span class="sc">+</span> work_type <span class="sc">+</span> Residence_type <span class="sc">+</span> avg_glucose_level <span class="sc">+</span> bmi <span class="sc">+</span> smoking_status, <span class="at">data=</span>LR_stroke1, <span class="at">family =</span> binomial)</span>
<span id="cb91-140"><a href="#cb91-140" aria-hidden="true" tabindex="-1"></a><span class="co"># Get Predicted Probabilities for each observation</span></span>
<span id="cb91-141"><a href="#cb91-141" aria-hidden="true" tabindex="-1"></a>pred_prob <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_CM, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb91-142"><a href="#cb91-142" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"caret"</span>)</span>
<span id="cb91-143"><a href="#cb91-143" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb91-144"><a href="#cb91-144" aria-hidden="true" tabindex="-1"></a><span class="co"># create 10 confusion matrices at threshold intervals between 1 and 0 to create a ROC</span></span>
<span id="cb91-145"><a href="#cb91-145" aria-hidden="true" tabindex="-1"></a><span class="co">#Classify prediction using a threshold (0.5 is common but can adjust)</span></span>
<span id="cb91-146"><a href="#cb91-146" aria-hidden="true" tabindex="-1"></a><span class="co">#---------------------------IF 1 row is all 0's then model doesn't show any predictability-------------------#</span></span>
<span id="cb91-147"><a href="#cb91-147" aria-hidden="true" tabindex="-1"></a><span class="co"># At threshold of around 1.0 #</span></span>
<span id="cb91-148"><a href="#cb91-148" aria-hidden="true" tabindex="-1"></a>pred_class <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">ifelse</span>(pred_prob <span class="sc">&gt;</span> .<span class="dv">99</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb91-149"><a href="#cb91-149" aria-hidden="true" tabindex="-1"></a>conf_matrix <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_class, <span class="fu">factor</span>(LR_stroke1<span class="sc">$</span>stroke, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"0"</span>, <span class="st">"1"</span>)), <span class="at">positive =</span> <span class="st">"1"</span>)</span>
<span id="cb91-150"><a href="#cb91-150" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(conf_matrix<span class="sc">$</span>table)</span>
<span id="cb91-151"><a href="#cb91-151" aria-hidden="true" tabindex="-1"></a><span class="co">#-------------------------IF 1 row is all 0's then model doesn't show any predictability-----------------------#</span></span>
<span id="cb91-152"><a href="#cb91-152" aria-hidden="true" tabindex="-1"></a><span class="co"># At threshold of 0.9 #</span></span>
<span id="cb91-153"><a href="#cb91-153" aria-hidden="true" tabindex="-1"></a>pred_class <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">ifelse</span>(pred_prob <span class="sc">&gt;</span> <span class="fl">0.9</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb91-154"><a href="#cb91-154" aria-hidden="true" tabindex="-1"></a>conf_matrix <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_class, <span class="fu">factor</span>(LR_stroke1<span class="sc">$</span>stroke, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"0"</span>, <span class="st">"1"</span>)), <span class="at">positive =</span> <span class="st">"1"</span>)</span>
<span id="cb91-155"><a href="#cb91-155" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(conf_matrix<span class="sc">$</span>table)</span>
<span id="cb91-156"><a href="#cb91-156" aria-hidden="true" tabindex="-1"></a><span class="co">#-----------------------IF 1 row is all 0's then model doesn't show any predictability--------------------------#</span></span>
<span id="cb91-157"><a href="#cb91-157" aria-hidden="true" tabindex="-1"></a><span class="co"># At threshold of 0.8#</span></span>
<span id="cb91-158"><a href="#cb91-158" aria-hidden="true" tabindex="-1"></a>pred_class <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">ifelse</span>(pred_prob <span class="sc">&gt;</span> <span class="fl">0.8</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb91-159"><a href="#cb91-159" aria-hidden="true" tabindex="-1"></a>conf_matrix <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_class, <span class="fu">factor</span>(LR_stroke1<span class="sc">$</span>stroke, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"0"</span>, <span class="st">"1"</span>)), <span class="at">positive =</span> <span class="st">"1"</span>)</span>
<span id="cb91-160"><a href="#cb91-160" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(conf_matrix<span class="sc">$</span>table)</span>
<span id="cb91-161"><a href="#cb91-161" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------IF 1 row is all 0's then model doesn't show any predictability---------------------------#</span></span>
<span id="cb91-162"><a href="#cb91-162" aria-hidden="true" tabindex="-1"></a><span class="co"># At threshold of 0.7#</span></span>
<span id="cb91-163"><a href="#cb91-163" aria-hidden="true" tabindex="-1"></a>pred_class <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">ifelse</span>(pred_prob <span class="sc">&gt;</span> <span class="fl">0.7</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb91-164"><a href="#cb91-164" aria-hidden="true" tabindex="-1"></a>conf_matrix <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_class, <span class="fu">factor</span>(LR_stroke1<span class="sc">$</span>stroke, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"0"</span>, <span class="st">"1"</span>)), <span class="at">positive =</span> <span class="st">"1"</span>)</span>
<span id="cb91-165"><a href="#cb91-165" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(conf_matrix<span class="sc">$</span>table)</span>
<span id="cb91-166"><a href="#cb91-166" aria-hidden="true" tabindex="-1"></a><span class="co"># At threshold of 0.6#</span></span>
<span id="cb91-167"><a href="#cb91-167" aria-hidden="true" tabindex="-1"></a>pred_class <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">ifelse</span>(pred_prob <span class="sc">&gt;</span> <span class="fl">0.6</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb91-168"><a href="#cb91-168" aria-hidden="true" tabindex="-1"></a>conf_matrix <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_class, <span class="fu">factor</span>(LR_stroke1<span class="sc">$</span>stroke, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"0"</span>, <span class="st">"1"</span>)), <span class="at">positive =</span> <span class="st">"1"</span>)</span>
<span id="cb91-169"><a href="#cb91-169" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(conf_matrix<span class="sc">$</span>table)</span>
<span id="cb91-170"><a href="#cb91-170" aria-hidden="true" tabindex="-1"></a><span class="do">################################################################################################################</span></span>
<span id="cb91-171"><a href="#cb91-171" aria-hidden="true" tabindex="-1"></a><span class="co">#-----------------------------at threshold of 0.6 that starts the models predictability------------------------#</span></span>
<span id="cb91-172"><a href="#cb91-172" aria-hidden="true" tabindex="-1"></a><span class="do">################################################################################################################</span></span>
<span id="cb91-173"><a href="#cb91-173" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract precision,Recall and F1 from confusion matrix using the caret package #</span></span>
<span id="cb91-174"><a href="#cb91-174" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> conf_matrix<span class="sc">$</span>byClass[<span class="st">"Pos Pred Value"</span>] </span>
<span id="cb91-175"><a href="#cb91-175" aria-hidden="true" tabindex="-1"></a>recall <span class="ot">&lt;-</span> conf_matrix<span class="sc">$</span>byClass[<span class="st">"Sensitivity"</span>]</span>
<span id="cb91-176"><a href="#cb91-176" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> ((precision <span class="sc">*</span> recall)<span class="sc">/</span> (precision <span class="sc">+</span> recall))</span>
<span id="cb91-177"><a href="#cb91-177" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(f1)</span>
<span id="cb91-178"><a href="#cb91-178" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(recall)</span>
<span id="cb91-179"><a href="#cb91-179" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(precision)</span>
<span id="cb91-180"><a href="#cb91-180" aria-hidden="true" tabindex="-1"></a><span class="co"># at threshold of 0.5#</span></span>
<span id="cb91-181"><a href="#cb91-181" aria-hidden="true" tabindex="-1"></a>pred_class <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">ifelse</span>(pred_prob <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb91-182"><a href="#cb91-182" aria-hidden="true" tabindex="-1"></a>conf_matrix <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_class, <span class="fu">factor</span>(LR_stroke1<span class="sc">$</span>stroke, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"0"</span>, <span class="st">"1"</span>)), <span class="at">positive =</span> <span class="st">"1"</span>)</span>
<span id="cb91-183"><a href="#cb91-183" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(conf_matrix<span class="sc">$</span>table)</span>
<span id="cb91-184"><a href="#cb91-184" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract precision,Recall and F1 from confusion matrix using the caret package #</span></span>
<span id="cb91-185"><a href="#cb91-185" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> conf_matrix<span class="sc">$</span>byClass[<span class="st">"Pos Pred Value"</span>] </span>
<span id="cb91-186"><a href="#cb91-186" aria-hidden="true" tabindex="-1"></a>recall <span class="ot">&lt;-</span> conf_matrix<span class="sc">$</span>byClass[<span class="st">"Sensitivity"</span>]</span>
<span id="cb91-187"><a href="#cb91-187" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> ((precision <span class="sc">*</span> recall)<span class="sc">/</span> (precision <span class="sc">+</span> recall))</span>
<span id="cb91-188"><a href="#cb91-188" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(f1)</span>
<span id="cb91-189"><a href="#cb91-189" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(recall)</span>
<span id="cb91-190"><a href="#cb91-190" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(precision)</span>
<span id="cb91-191"><a href="#cb91-191" aria-hidden="true" tabindex="-1"></a><span class="co"># At threshold of 0.4#</span></span>
<span id="cb91-192"><a href="#cb91-192" aria-hidden="true" tabindex="-1"></a>pred_class <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">ifelse</span>(pred_prob <span class="sc">&gt;</span> <span class="fl">0.4</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb91-193"><a href="#cb91-193" aria-hidden="true" tabindex="-1"></a>conf_matrix <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_class, <span class="fu">factor</span>(LR_stroke1<span class="sc">$</span>stroke, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"0"</span>, <span class="st">"1"</span>)), <span class="at">positive =</span> <span class="st">"1"</span>)</span>
<span id="cb91-194"><a href="#cb91-194" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(conf_matrix<span class="sc">$</span>table)</span>
<span id="cb91-195"><a href="#cb91-195" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract precision,Recall and F1 from confusion matrix using the caret package #</span></span>
<span id="cb91-196"><a href="#cb91-196" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> conf_matrix<span class="sc">$</span>byClass[<span class="st">"Pos Pred Value"</span>] </span>
<span id="cb91-197"><a href="#cb91-197" aria-hidden="true" tabindex="-1"></a>recall <span class="ot">&lt;-</span> conf_matrix<span class="sc">$</span>byClass[<span class="st">"Sensitivity"</span>]</span>
<span id="cb91-198"><a href="#cb91-198" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> ((precision <span class="sc">*</span> recall)<span class="sc">/</span> (precision <span class="sc">+</span> recall))</span>
<span id="cb91-199"><a href="#cb91-199" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(f1)</span>
<span id="cb91-200"><a href="#cb91-200" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(recall)</span>
<span id="cb91-201"><a href="#cb91-201" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(precision)</span>
<span id="cb91-202"><a href="#cb91-202" aria-hidden="true" tabindex="-1"></a><span class="co"># at threshold of 0.3#</span></span>
<span id="cb91-203"><a href="#cb91-203" aria-hidden="true" tabindex="-1"></a>pred_class <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">ifelse</span>(pred_prob <span class="sc">&gt;</span> <span class="fl">0.3</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb91-204"><a href="#cb91-204" aria-hidden="true" tabindex="-1"></a>conf_matrix <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_class, <span class="fu">factor</span>(LR_stroke1<span class="sc">$</span>stroke, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"0"</span>, <span class="st">"1"</span>)), <span class="at">positive =</span> <span class="st">"1"</span>)</span>
<span id="cb91-205"><a href="#cb91-205" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(conf_matrix<span class="sc">$</span>table)</span>
<span id="cb91-206"><a href="#cb91-206" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract precision,Recall and F1 from confusion matrix using the caret package #</span></span>
<span id="cb91-207"><a href="#cb91-207" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> conf_matrix<span class="sc">$</span>byClass[<span class="st">"Pos Pred Value"</span>] </span>
<span id="cb91-208"><a href="#cb91-208" aria-hidden="true" tabindex="-1"></a>recall <span class="ot">&lt;-</span> conf_matrix<span class="sc">$</span>byClass[<span class="st">"Sensitivity"</span>]</span>
<span id="cb91-209"><a href="#cb91-209" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> ((precision <span class="sc">*</span> recall)<span class="sc">/</span> (precision <span class="sc">+</span> recall))</span>
<span id="cb91-210"><a href="#cb91-210" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(f1)</span>
<span id="cb91-211"><a href="#cb91-211" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(recall)</span>
<span id="cb91-212"><a href="#cb91-212" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(precision)</span>
<span id="cb91-213"><a href="#cb91-213" aria-hidden="true" tabindex="-1"></a><span class="co"># at threshold of 0.2#</span></span>
<span id="cb91-214"><a href="#cb91-214" aria-hidden="true" tabindex="-1"></a>pred_class <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">ifelse</span>(pred_prob <span class="sc">&gt;</span> <span class="fl">0.2</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb91-215"><a href="#cb91-215" aria-hidden="true" tabindex="-1"></a>conf_matrix <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_class, <span class="fu">factor</span>(LR_stroke1<span class="sc">$</span>stroke, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"0"</span>, <span class="st">"1"</span>)), <span class="at">positive =</span> <span class="st">"1"</span>)</span>
<span id="cb91-216"><a href="#cb91-216" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(conf_matrix<span class="sc">$</span>table)</span>
<span id="cb91-217"><a href="#cb91-217" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract precision,Recall and F1 from confusion matrix using the caret package #</span></span>
<span id="cb91-218"><a href="#cb91-218" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> conf_matrix<span class="sc">$</span>byClass[<span class="st">"Pos Pred Value"</span>] </span>
<span id="cb91-219"><a href="#cb91-219" aria-hidden="true" tabindex="-1"></a>recall <span class="ot">&lt;-</span> conf_matrix<span class="sc">$</span>byClass[<span class="st">"Sensitivity"</span>]</span>
<span id="cb91-220"><a href="#cb91-220" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> ((precision <span class="sc">*</span> recall)<span class="sc">/</span> (precision <span class="sc">+</span> recall))</span>
<span id="cb91-221"><a href="#cb91-221" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(f1)</span>
<span id="cb91-222"><a href="#cb91-222" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(recall)</span>
<span id="cb91-223"><a href="#cb91-223" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(precision)</span>
<span id="cb91-224"><a href="#cb91-224" aria-hidden="true" tabindex="-1"></a><span class="co"># At Threshold of 0.18#</span></span>
<span id="cb91-225"><a href="#cb91-225" aria-hidden="true" tabindex="-1"></a>pred_class <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">ifelse</span>(pred_prob <span class="sc">&gt;</span> <span class="fl">0.18</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb91-226"><a href="#cb91-226" aria-hidden="true" tabindex="-1"></a>conf_matrix <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_class, <span class="fu">factor</span>(LR_stroke1<span class="sc">$</span>stroke, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"0"</span>, <span class="st">"1"</span>)), <span class="at">positive =</span> <span class="st">"1"</span>)</span>
<span id="cb91-227"><a href="#cb91-227" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(conf_matrix<span class="sc">$</span>table)</span>
<span id="cb91-228"><a href="#cb91-228" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract precision,Recall and F1 from confusion matrix using the caret package #</span></span>
<span id="cb91-229"><a href="#cb91-229" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> conf_matrix<span class="sc">$</span>byClass[<span class="st">"Pos Pred Value"</span>] </span>
<span id="cb91-230"><a href="#cb91-230" aria-hidden="true" tabindex="-1"></a>recall <span class="ot">&lt;-</span> conf_matrix<span class="sc">$</span>Class[<span class="st">"Sensitivity"</span>]</span>
<span id="cb91-231"><a href="#cb91-231" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> ((precision <span class="sc">*</span> recall)<span class="sc">/</span> (precision <span class="sc">+</span> recall))</span>
<span id="cb91-232"><a href="#cb91-232" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(f1)</span>
<span id="cb91-233"><a href="#cb91-233" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(recall)</span>
<span id="cb91-234"><a href="#cb91-234" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(precision)</span>
<span id="cb91-235"><a href="#cb91-235" aria-hidden="true" tabindex="-1"></a><span class="co"># At threshold of 0.15#</span></span>
<span id="cb91-236"><a href="#cb91-236" aria-hidden="true" tabindex="-1"></a>pred_class <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">ifelse</span>(pred_prob <span class="sc">&gt;</span> <span class="fl">0.15</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb91-237"><a href="#cb91-237" aria-hidden="true" tabindex="-1"></a>conf_matrix <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_class, <span class="fu">factor</span>(LR_stroke1<span class="sc">$</span>stroke, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"0"</span>, <span class="st">"1"</span>)), <span class="at">positive =</span> <span class="st">"1"</span>)</span>
<span id="cb91-238"><a href="#cb91-238" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(conf_matrix<span class="sc">$</span>table)</span>
<span id="cb91-239"><a href="#cb91-239" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract precision,Recall and F1 from confusion matrix using the caret package #</span></span>
<span id="cb91-240"><a href="#cb91-240" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> conf_matrix<span class="sc">$</span>byClass[<span class="st">"Pos Pred Value"</span>] </span>
<span id="cb91-241"><a href="#cb91-241" aria-hidden="true" tabindex="-1"></a>recall <span class="ot">&lt;-</span> conf_matrix<span class="sc">$</span>byClass[<span class="st">"Sensitivity"</span>]</span>
<span id="cb91-242"><a href="#cb91-242" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> ((precision <span class="sc">*</span> recall)<span class="sc">/</span> (precision <span class="sc">+</span> recall))</span>
<span id="cb91-243"><a href="#cb91-243" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(f1)</span>
<span id="cb91-244"><a href="#cb91-244" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(recall)</span>
<span id="cb91-245"><a href="#cb91-245" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(precision)</span>
<span id="cb91-246"><a href="#cb91-246" aria-hidden="true" tabindex="-1"></a><span class="co"># at threshold of 0.1#</span></span>
<span id="cb91-247"><a href="#cb91-247" aria-hidden="true" tabindex="-1"></a>pred_class <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">ifelse</span>(pred_prob <span class="sc">&gt;</span> <span class="fl">0.1</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb91-248"><a href="#cb91-248" aria-hidden="true" tabindex="-1"></a>conf_matrix <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_class, <span class="fu">factor</span>(LR_stroke1<span class="sc">$</span>stroke, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"0"</span>, <span class="st">"1"</span>)), <span class="at">positive =</span> <span class="st">"1"</span>)</span>
<span id="cb91-249"><a href="#cb91-249" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(conf_matrix<span class="sc">$</span>table)</span>
<span id="cb91-250"><a href="#cb91-250" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract precision,Recall and F1 from confusion matrix using the caret package #</span></span>
<span id="cb91-251"><a href="#cb91-251" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> conf_matrix<span class="sc">$</span>byClass[<span class="st">"Pos Pred Value"</span>] </span>
<span id="cb91-252"><a href="#cb91-252" aria-hidden="true" tabindex="-1"></a>recall <span class="ot">&lt;-</span> conf_matrix<span class="sc">$</span>byClass[<span class="st">"Sensitivity"</span>]</span>
<span id="cb91-253"><a href="#cb91-253" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> ((precision <span class="sc">*</span> recall)<span class="sc">/</span> (precision <span class="sc">+</span> recall))</span>
<span id="cb91-254"><a href="#cb91-254" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(f1)</span>
<span id="cb91-255"><a href="#cb91-255" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(recall)</span>
<span id="cb91-256"><a href="#cb91-256" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(precision)</span>
<span id="cb91-257"><a href="#cb91-257" aria-hidden="true" tabindex="-1"></a><span class="co"># at threshold of 0.05#</span></span>
<span id="cb91-258"><a href="#cb91-258" aria-hidden="true" tabindex="-1"></a>pred_class <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">ifelse</span>(pred_prob <span class="sc">&gt;</span> <span class="fl">0.05</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb91-259"><a href="#cb91-259" aria-hidden="true" tabindex="-1"></a>conf_matrix <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_class, <span class="fu">factor</span>(LR_stroke1<span class="sc">$</span>stroke, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"0"</span>, <span class="st">"1"</span>)), <span class="at">positive =</span> <span class="st">"1"</span>)</span>
<span id="cb91-260"><a href="#cb91-260" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(conf_matrix<span class="sc">$</span>table)</span>
<span id="cb91-261"><a href="#cb91-261" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract precision,Recall and F1 from confusion matrix using the caret package #</span></span>
<span id="cb91-262"><a href="#cb91-262" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> conf_matrix<span class="sc">$</span>byClass[<span class="st">"Pos Pred Value"</span>] </span>
<span id="cb91-263"><a href="#cb91-263" aria-hidden="true" tabindex="-1"></a>recall <span class="ot">&lt;-</span> conf_matrix<span class="sc">$</span>byClass[<span class="st">"Sensitivity"</span>]</span>
<span id="cb91-264"><a href="#cb91-264" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> ((precision <span class="sc">*</span> recall)<span class="sc">/</span> (precision <span class="sc">+</span> recall))</span>
<span id="cb91-265"><a href="#cb91-265" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(f1)</span>
<span id="cb91-266"><a href="#cb91-266" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(recall)</span>
<span id="cb91-267"><a href="#cb91-267" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(precision)</span>
<span id="cb91-268"><a href="#cb91-268" aria-hidden="true" tabindex="-1"></a><span class="co"># Using the different Confusion Matrices, Create the ROC curve</span></span>
<span id="cb91-269"><a href="#cb91-269" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<section id="references" class="level3">
<h3 class="anchored" data-anchor-id="references">References</h3>
<div id="refs" role="list">

</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>